<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุฑูุฒ ุงูุฃูุนุงุจ ุงูุฅุณูุงูู</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
            background: #fdfbf7;
            overflow-x: hidden;
            touch-action: manipulation;
        }

        /* --- Shared Styles --- */
        .btn-hover { transition: all 0.2s; }
        .btn-hover:active { transform: scale(0.95); }

        /* --- Crossword Styles --- */
        .letter-box {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
        .letter-box.filled { background-color: #ffffff; border-color: #1a472a; transform: translateY(-2px); }
        .letter-box.correct { background-color: #d4af9d; border-color: #b4975a; color: #1a472a; animation: bounce 0.5s; }
        .letter-box.wrong { background-color: #d4a5a5; border-color: #8b7355; animation: shake 0.5s; }

        /* --- Hexagon Game Styles --- */
        .hex-wrapper {
            background: white;
            padding: 20px;
            border-radius: 20px;
            border: 4px solid #efe9d9;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .hex-row {
            display: flex;
            justify-content: center;
            margin-bottom: -10px;
        }
        
        .hex-row:nth-child(even) {
            margin-right: 55px; 
        }

        .hex-cell {
            width: 55px;
            height: 60px;
            margin: 3px;
            background-color: #f0ebe0; 
            clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 900;
            font-size: 1.4rem;
            color: #b4975a;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            z-index: 10;
            border: 2px solid transparent; 
        }
        
        .hex-cell:hover:not(.locked) {
            background-color: #b4975a;
            color: white;
            transform: scale(1.1);
            z-index: 20;
        }

        .hex-cell.team1 { background-color: #1a472a; color: white; } 
        .hex-cell.team2 { background-color: #d84545; color: white; } 
        .hex-cell.locked { cursor: default; }

        /* --- Connect 4 Styles --- */
        .c4-board {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 8px;
            background-color: #b4975a; /* Wooden/Gold frame color */
            padding: 10px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border: 4px solid #8b7355;
        }
        .c4-col {
            display: flex;
            flex-direction: column;
            gap: 8px;
            cursor: pointer;
            padding: 5px 0;
            border-radius: 10px;
            transition: background-color 0.2s;
        }
        .c4-col:hover {
            background-color: rgba(255,255,255,0.2);
        }
        .c4-cell {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background-color: #f0ebe0; /* Empty slot */
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);
            transition: all 0.4s cubic-bezier(1,-0.01,.39,1.44); /* Bounce effect */
        }
        .c4-cell.p1 { background-color: #1a472a; box-shadow: inset 0 -2px 4px rgba(0,0,0,0.3); } /* Green */
        .c4-cell.p2 { background-color: #d84545; box-shadow: inset 0 -2px 4px rgba(0,0,0,0.3); } /* Red */
        
        @media (min-width: 640px) {
            .c4-cell { width: 55px; height: 55px; }
            .c4-board { gap: 12px; padding: 15px; }
            .c4-col { gap: 12px; }
        }

        @keyframes bounce { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
        .animate-pop { animation: bounce 0.4s ease-out; }
        .animate-sway { animation: sway 3s ease-in-out infinite; }
        @keyframes sway { 0%, 100% { transform: rotate(-5deg); } 50% { transform: rotate(5deg); } }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center text-gray-800 p-2">

    <!-- Audio System -->
    <script>
        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gainNode = audioCtx.createGain();
            osc.connect(gainNode);
            gainNode.connect(audioCtx.destination);
            const now = audioCtx.currentTime;

            if (type === 'correct') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(500, now);
                osc.frequency.exponentialRampToValueAtTime(1000, now + 0.1);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.5);
                osc.start(now);
                osc.stop(now + 0.5);
            } else if (type === 'wrong') {
                osc.type = 'triangle'; 
                osc.frequency.setValueAtTime(150, now);
                osc.frequency.exponentialRampToValueAtTime(50, now + 0.4);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.4);
                osc.start(now);
                osc.stop(now + 0.4);
            } else if (type === 'click') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800, now);
                gainNode.gain.setValueAtTime(0.05, now);
                gainNode.gain.exponentialRampToValueAtTime(0.001, now + 0.1);
                osc.start(now);
                osc.stop(now + 0.1);
            } else if (type === 'win') {
                osc.type = 'square';
                osc.frequency.setValueAtTime(400, now);
                osc.frequency.linearRampToValueAtTime(600, now + 0.1);
                osc.frequency.linearRampToValueAtTime(400, now + 0.2);
                osc.frequency.linearRampToValueAtTime(800, now + 0.4);
                gainNode.gain.setValueAtTime(0.1, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.6);
                osc.start(now);
                osc.stop(now + 0.6);
            } else if (type === 'warning') {
                // ุตูุช ุชูุจูู ููููุช ุงููุชุจูู
                osc.type = 'sine';
                osc.frequency.setValueAtTime(800, now);
                gainNode.gain.setValueAtTime(0.08, now);
                gainNode.gain.linearRampToValueAtTime(0, now + 0.15);
                osc.start(now);
                osc.stop(now + 0.15);
            }
        }
    </script>

    <!-- App Container -->
    <div id="app" class="w-full max-w-2xl bg-white/95 backdrop-blur-sm rounded-3xl shadow-xl overflow-hidden min-h-[700px] relative border border-[#efe9d9]">
        
        <!-- Header -->
        <div class="h-2 bg-gradient-to-r from-[#b4975a] to-[#1a472a] w-full"></div>

        <!-- === SCREEN 0: MAIN MENU === -->
        <div id="screen-menu" class="p-6 flex flex-col items-center justify-center h-full min-h-[650px] animate-fade-in text-center space-y-8">
            <div class="space-y-2">
                <span class="text-7xl animate-sway inline-block">๐</span>
                <h1 class="text-5xl font-black text-[#1a472a] tracking-tight">ูุงุญุฉ ุงูุฃูุนุงุจ</h1>
                <p class="text-[#b4975a] text-xl font-medium">ูุณุงุจูุงุช ุซูุงููุฉ ูุฅุณูุงููุฉ</p>
            </div>

            <div class="w-full max-w-md bg-[#f0ebe0] p-6 rounded-2xl border border-[#efe9d9]">
                <h3 class="text-sm font-bold text-[#1a472a] mb-3 text-right">ุฃุณูุงุก ุงููุฑู:</h3>
                <div class="flex flex-col gap-3">
                    <input type="text" id="g-team1" placeholder="ุงููุฑูู ุงูุฃูู (ุงูุฃุฎุถุฑ)" class="w-full px-4 py-3 rounded-xl border border-[#efe9d9] text-right focus:ring-2 focus:ring-[#b4975a] outline-none bg-white">
                    <input type="text" id="g-team2" placeholder="ุงููุฑูู ุงูุซุงูู (ุงูุฃุญูุฑ)" class="w-full px-4 py-3 rounded-xl border border-[#efe9d9] text-right focus:ring-2 focus:ring-[#b4975a] outline-none bg-white">
                </div>
            </div>

            <div class="grid grid-cols-2 gap-4 w-full max-w-lg">
                <button onclick="launchGame('crossword')" class="group bg-white border-2 border-[#efe9d9] hover:border-[#b4975a] rounded-2xl p-4 transition-all hover:shadow-lg btn-hover flex flex-col items-center justify-center h-32 relative overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-r from-blue-50 to-purple-50 opacity-50"></div>
                    <span class="text-4xl mb-2 relative z-10">๐</span>
                    <span class="font-bold text-[#1a472a] text-sm relative z-10">ุงููููุงุช ุงููุชูุงุทุนุฉ</span>
                    <span class="text-[10px] text-[#b4975a] mt-1 relative z-10 font-bold">ุฃุณุฆูุฉ ุฅุณูุงููุฉ ุซูุงููุฉ</span>
                </button>

                <button onclick="launchGame('hexagon')" class="group bg-white border-2 border-[#efe9d9] hover:border-[#b4975a] rounded-2xl p-4 transition-all hover:shadow-lg btn-hover flex flex-col items-center justify-center h-32 relative overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-r from-purple-50 to-pink-50 opacity-50"></div>
                    <span class="text-4xl mb-2 relative z-10">โฌก</span>
                    <span class="font-bold text-[#1a472a] text-sm relative z-10">ูุณุงุจูุฉ ุงูุญุฑูู</span>
                    <span class="text-[10px] text-[#b4975a] mt-1 relative z-10 font-bold">ูุนุจุฉ ุณุฑุนุฉ ูุฐุงูุฑุฉ</span>
                </button>

                <button onclick="launchGame('connect4')" class="col-span-2 group bg-white border-2 border-[#efe9d9] hover:border-[#b4975a] rounded-2xl p-4 transition-all hover:shadow-lg btn-hover flex flex-col items-center justify-center h-32 relative overflow-hidden">
                    <div class="absolute inset-0 bg-gradient-to-r from-green-50 to-red-50 opacity-50"></div>
                    <span class="text-4xl mb-2 relative z-10">๐ดโช๐ข</span>
                    <span class="font-bold text-[#1a472a] text-sm relative z-10">ุฃุฑุจุนุฉ ุชุฑุจุญ</span>
                    <span class="text-[10px] text-[#b4975a] mt-1 relative z-10 font-bold">ูุนุจุฉ ุฐูุงุก ูุงุณุชุฑุงุชูุฌูุฉ</span>
                </button>
            </div>
        </div>

        <!-- === SCREEN 1: CROSSWORD GAME === -->
        <div id="screen-crossword" class="hidden flex flex-col h-full relative min-h-[650px]">
            <div class="flex justify-between items-center bg-[#f0ebe0] p-3 border-b border-[#efe9d9]">
                <button onclick="goHome()" class="text-xs bg-white border border-[#efe9d9] px-3 py-1 rounded-full hover:bg-[#fdfbf7] font-bold text-[#b4975a]">๐ ุฎุฑูุฌ</button>
                <div class="font-bold text-[#1a472a]">ุงููููุงุช ุงููุชูุงุทุนุฉ</div>
                <div class="text-xs font-bold bg-white px-3 py-1 rounded-full border border-[#efe9d9] text-[#b4975a]">ูุฑุญูุฉ <span id="cw-stage">1</span></div>
            </div>
            
            <div class="flex justify-between p-2 bg-white border-b border-[#efe9d9]">
                <div id="cw-t1-box" class="flex-1 text-center p-2 rounded-lg border-2 border-[#b4975a] bg-[#f0ebe0] transition-all">
                    <div id="cw-t1-name" class="font-bold text-sm text-[#1a472a]"></div>
                    <div id="cw-t1-score" class="text-2xl font-black text-[#b4975a]">0</div>
                    <div id="cw-t1-hearts" class="text-xs tracking-widest mt-1">โค๏ธโค๏ธโค๏ธโค๏ธโค๏ธ</div>
                </div>
                <div class="px-3 flex flex-col justify-center items-center">
                    <div id="cw-timer" class="w-20 h-20 rounded-full bg-[#1a472a] text-white flex items-center justify-center font-black text-4xl shadow-lg">60</div>
                </div>
                <div id="cw-t2-box" class="flex-1 text-center p-2 rounded-lg border-2 border-transparent opacity-50 transition-all">
                    <div id="cw-t2-name" class="font-bold text-sm text-[#1a472a]"></div>
                    <div id="cw-t2-score" class="text-2xl font-black text-[#b4975a]">0</div>
                    <div id="cw-t2-hearts" class="text-xs tracking-widest mt-1">โค๏ธโค๏ธโค๏ธโค๏ธโค๏ธ</div>
                </div>
            </div>

            <div class="flex-1 overflow-y-auto p-4 flex flex-col items-center">
                <div id="cw-turn-msg" class="mb-4 px-6 py-2 bg-[#d4af9d] text-[#1a472a] rounded-full text-sm font-bold animate-pulse shadow-sm"></div>
                
                <div class="bg-[#f0ebe0] w-full p-4 rounded-xl border border-[#efe9d9] mb-6 text-center">
                     <h2 id="cw-question" class="text-xl md:text-2xl font-bold text-[#1a472a] leading-relaxed">...</h2>
                </div>
                
                <div id="cw-grid" class="flex flex-wrap gap-2 justify-center mb-6" dir="rtl"></div>
                <div id="cw-feedback" class="h-6 mb-2 text-center font-bold text-sm"></div>

                <div class="mt-auto w-full max-w-md space-y-3">
                    <button onclick="cwUseHint()" id="cw-hint-btn" class="w-full py-3 bg-[#f0ebe0] text-[#b4975a] border border-[#efe9d9] rounded-xl font-bold text-sm hover:bg-[#efe9d9] transition flex items-center justify-center gap-2">
                        <span>๐ก</span> <span>ุงุณุชุฎุฏุงู ูุณุงุนุฏุฉ (ูุดู ุญุฑู)</span>
                    </button>
                    <div id="cw-keyboard" class="grid grid-cols-7 gap-1.5"></div>
                    <button onclick="cwBackspace()" class="w-full py-3 bg-[#d4a5a5] text-[#1a472a] border border-[#efe9d9] rounded-xl font-bold hover:bg-[#c49494] flex justify-center gap-2 transition">
                        <span>ูุณุญ</span> โซ
                    </button>
                </div>
            </div>
        </div>

        <!-- === SCREEN 2: HEXAGON GAME === -->
        <div id="screen-hexagon" class="hidden flex flex-col h-full relative min-h-[650px]">
            <div class="flex justify-between items-center bg-gray-50 p-3 border-b">
                <button onclick="goHome()" class="text-xs bg-white border px-3 py-1 rounded-full hover:bg-gray-100 font-bold text-gray-600">๐ ุฎุฑูุฌ</button>
                <div class="font-bold text-gray-700">ูุณุงุจูุฉ ุงูุญุฑูู</div>
                <div class="text-xs text-gray-500 font-bold bg-white px-2 py-1 rounded border">ุงููุงุฆุฒ ูู 3 ุฌููุงุช</div>
            </div>

            <div class="flex justify-between p-3 bg-white">
                <div id="hex-t1-box" class="p-2 rounded-md bg-green-50 border border-green-300 text-center transition-all shadow-sm max-w-xs">
                    <div class="text-[8px] font-bold text-green-700 mb-1 flex items-center justify-center gap-0.5 opacity-70">
                        <span>ุงููููู</span> โ๏ธ <span>ุงููุณุงุฑ</span>
                    </div>
                    <div id="hex-t1-name" class="font-bold text-green-900 text-sm mb-1"></div>
                    <div id="hex-t1-wins" class="flex justify-center gap-1 text-lg">
                        <span class="text-gray-300">โ</span><span class="text-gray-300">โ</span><span class="text-gray-300">โ</span>
                    </div>
                </div>
                
                <div id="hex-t2-box" class="p-2 rounded-md bg-red-50 border border-red-300 text-center opacity-50 transition-all shadow-sm max-w-xs">
                    <div class="text-[8px] font-bold text-red-700 mb-1 flex items-center justify-center gap-0.5 opacity-70">
                         <span>ุงูุฃุนูู</span> โ๏ธ <span>ุงูุฃุณูู</span>
                    </div>
                    <div id="hex-t2-name" class="font-bold text-red-900 text-sm mb-1"></div>
                    <div id="hex-t2-wins" class="flex justify-center gap-1 text-lg">
                        <span class="text-gray-300">โ</span><span class="text-gray-300">โ</span><span class="text-gray-300">โ</span>
                    </div>
                </div>
            </div>

            <div id="hex-status" class="text-center text-sm font-bold py-2 bg-gray-100 text-gray-600 border-y border-gray-200">
                ุงุฎุชุฑ ุญุฑูุงู ููุจุฏุก
            </div>

            <div class="flex-1 flex items-center justify-center p-4 bg-gray-50 overflow-y-auto">
                <div class="hex-wrapper shadow-lg">
                    <div class="absolute -top-6 text-red-400 font-bold text-xs tracking-widest">โผ ุงููุฑูู ุงูุฃุญูุฑ โผ</div>
                    <div class="absolute -bottom-6 text-red-400 font-bold text-xs tracking-widest">โฒ ุงููุฑูู ุงูุฃุญูุฑ โฒ</div>
                    <div class="absolute -right-8 top-1/2 -translate-y-1/2 text-green-500 font-bold text-xs tracking-widest [writing-mode:vertical-rl] rotate-180">โ ุงููุฑูู ุงูุฃุฎุถุฑ</div>
                    <div class="absolute -left-8 top-1/2 -translate-y-1/2 text-green-500 font-bold text-xs tracking-widest [writing-mode:vertical-rl] rotate-180">ุงููุฑูู ุงูุฃุฎุถุฑ โบ</div>
                    <div id="hex-board"></div>
                </div>

                <div id="hex-modal" class="hidden absolute inset-0 bg-white/95 z-50 flex flex-col items-center justify-center p-6 animate-fade-in backdrop-blur-sm">
                    <button onclick="closeHexModal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">โ ุฅูุบุงุก</button>
                    <div id="hex-modal-timer" class="w-20 h-20 rounded-full bg-[#1a472a] text-white flex items-center justify-center font-black text-4xl shadow-lg mb-4 transition-colors duration-300">60</div>
                    <div class="w-20 h-20 rounded-full bg-gray-100 flex items-center justify-center text-4xl mb-6 font-black text-gray-600 border-4 border-gray-200 shadow-inner" id="hex-q-char">ุฃ</div>
                    <div class="w-full max-w-md bg-white p-6 rounded-2xl shadow-xl border border-gray-100 text-center">
                        <h3 id="hex-question-text" class="text-xl font-bold text-gray-800 mb-6 leading-relaxed">...</h3>
                        <div class="space-y-4">
                            <input type="text" id="hex-input" placeholder="ุงูุชุจ ุงูุฅุฌุงุจุฉ ููุง..." class="w-full text-center text-xl p-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition" autocomplete="off">
                            <button onclick="checkHexAnswer()" class="w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-blue-500/30 hover:-translate-y-0.5 transition">ุชุญูู ูู ุงูุฅุฌุงุจุฉ โ</button>
                        </div>
                        <div id="hex-feedback" class="h-6 mt-3 text-sm font-bold"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- === SCREEN 3: CONNECT 4 GAME (NEW) === -->
        <div id="screen-connect4" class="hidden flex flex-col h-full relative min-h-[650px]">
            <div class="flex justify-between items-center bg-gray-50 p-3 border-b">
                <button onclick="goHome()" class="text-xs bg-white border px-3 py-1 rounded-full hover:bg-gray-100 font-bold text-gray-600">๐ ุฎุฑูุฌ</button>
                <div class="font-bold text-gray-700">ุฃุฑุจุนุฉ ุชุฑุจุญ</div>
                <div class="text-xs text-gray-500 font-bold bg-white px-2 py-1 rounded border">ููู 4 ุจุตู ูุงุญุฏ</div>
            </div>

            <!-- Teams Status -->
            <div class="flex justify-between p-3 bg-white">
                <div id="c4-t1-box" class="p-2 px-4 rounded-md bg-green-50 border border-green-300 text-center transition-all shadow-sm">
                    <div class="text-[8px] font-bold text-green-700 mb-1 opacity-70">ุงููุฑูู ุงูุฃูู</div>
                    <div id="c4-t1-name" class="font-bold text-green-900 text-sm mb-1"></div>
                    <div class="w-4 h-4 rounded-full bg-[#1a472a] mx-auto border border-gray-300 shadow-inner"></div>
                </div>
                
                <div id="c4-status" class="flex-1 flex items-center justify-center font-bold text-sm text-gray-600 px-2 text-center">
                    ุงุฎุชุฑ ุนููุฏุงู ูุฅูุฒุงู ุงููุฑุต
                </div>

                <div id="c4-t2-box" class="p-2 px-4 rounded-md bg-red-50 border border-red-300 text-center opacity-50 transition-all shadow-sm">
                    <div class="text-[8px] font-bold text-red-700 mb-1 opacity-70">ุงููุฑูู ุงูุซุงูู</div>
                    <div id="c4-t2-name" class="font-bold text-red-900 text-sm mb-1"></div>
                    <div class="w-4 h-4 rounded-full bg-[#d84545] mx-auto border border-gray-300 shadow-inner"></div>
                </div>
            </div>

            <div class="flex-1 flex items-center justify-center p-4 bg-gray-100 overflow-y-auto">
                <div class="c4-board" id="c4-board">
                    <!-- Board Generated by JS -->
                </div>

                <!-- Connect 4 Question Modal -->
                <div id="c4-modal" class="hidden absolute inset-0 bg-white/95 z-50 flex flex-col items-center justify-center p-6 animate-fade-in backdrop-blur-sm">
                    <button onclick="closeC4Modal()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600">โ ุฅูุบุงุก</button>
                    
                    <div id="c4-modal-timer" class="w-20 h-20 rounded-full bg-[#1a472a] text-white flex items-center justify-center font-black text-4xl shadow-lg mb-4 transition-colors duration-300">60</div>

                    <div class="w-full max-w-md bg-white p-6 rounded-2xl shadow-xl border border-gray-100 text-center">
                        <span class="text-xs font-bold text-gray-400 tracking-widest mb-2 block">ุณุคุงู ุงูุชุญุฏู</span>
                        <h3 id="c4-question-text" class="text-xl font-bold text-gray-800 mb-6 leading-relaxed">...</h3>
                        
                        <div class="space-y-4">
                            <input type="text" id="c4-input" placeholder="ุงูุชุจ ุงูุฅุฌุงุจุฉ ููุง..." class="w-full text-center text-xl p-3 border-2 border-gray-300 rounded-xl focus:border-blue-500 focus:ring-2 focus:ring-blue-200 outline-none transition" autocomplete="off">
                            <button onclick="checkC4Answer()" class="w-full py-3 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl font-bold text-lg shadow-lg hover:shadow-blue-500/30 hover:-translate-y-0.5 transition">
                                ุชุญูู ูู ุงูุฅุฌุงุจุฉ โ
                            </button>
                        </div>
                        <div id="c4-feedback" class="h-6 mt-3 text-sm font-bold"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- === WIN SCREEN === -->
        <div id="screen-win" class="hidden absolute inset-0 bg-white z-[60] flex flex-col items-center justify-center p-8 text-center animate-pop">
            <div class="text-8xl mb-6 animate-bounce">๐</div>
            <h2 class="text-4xl font-black text-gray-800 mb-2">ุงููุงุฆุฒ ุจุงูุจุทููุฉ</h2>
            <h3 id="winner-name" class="text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-amber-500 to-orange-600 mb-8 py-2"></h3>
            <button onclick="goHome()" class="bg-gray-800 text-white px-10 py-4 rounded-xl font-bold hover:bg-gray-700 shadow-xl transition transform hover:scale-105">ุงููุงุฆูุฉ ุงูุฑุฆูุณูุฉ</button>
        </div>

        <!-- === ROUND WIN MODAL === -->
        <div id="round-win-modal" class="hidden absolute inset-0 bg-black/50 z-[55] flex flex-col items-center justify-center p-8 text-center backdrop-blur-sm animate-fade-in">
            <div class="bg-white p-8 rounded-3xl shadow-2xl max-w-sm w-full">
                <div class="text-6xl mb-4">๐</div>
                <h2 class="text-2xl font-black text-gray-800 mb-2">ุงูุชูุช ุงูุฌููุฉ!</h2>
                <p class="text-gray-600 mb-6">ุงููุงุฆุฒ ุจูุฐู ุงูุฌููุฉ: <span id="round-winner-name" class="font-bold text-green-600"></span></p>
                <button onclick="startNextHexRound()" class="w-full bg-blue-600 text-white px-6 py-3 rounded-xl font-bold hover:bg-blue-700 shadow-lg">ุจุฏุก ุงูุฌููุฉ ุงูุชุงููุฉ</button>
            </div>
        </div>

    </div>

    <!-- LOGIC -->
    <script>
        // --- GLOBAL STATE ---
        const gState = {
            team1: "ุงููุฑูู ุงูุฃุฎุถุฑ",
            team2: "ุงููุฑูู ุงูุฃุญูุฑ",
            currentGame: null 
        };

        // --- MASSIVE QUESTION BANK (Existing for Games 1 & 2) ---
        const questionBank = [
             { q: "ุฃูู ูุคุฐู ูู ุงูุฅุณูุงูุ", a: "ุจูุงู", char: "ุจ" },
            { q: "ุณูุฑุฉ ุชุนุฏู ุซูุซ ุงููุฑุขูุ", a: "ุงูุงุฎูุงุต", char: "ุง" },
            { q: "ุงุณู ูุงูุฉ ุงููุจู ๏ทบุ", a: "ุงููุตูุงุก", char: "ุง" },
            { q: "ุฎุงุฒู ุงููุงุฑ ูู ุงููุฑุขูุ", a: "ูุงูู", char: "ู" },
            { q: "ููุจ ุนุซูุงู ุจู ุนูุงูุ", a: "ุฐูุงูููุฑูู", char: "ุฐ" },
            { q: "ุบุฒูุฉ ูุณุฑุช ูููุง ุฑุจุงุนูุฉ ุงููุจูุ", a: "ุงุญุฏ", char: "ุง" },
            { q: "ูููู ุงููู ูู ุงููุจูุ", a: "ููุณู", char: "ู" },
            { q: "ุฒูุฌุฉ ุงููุจู ููู ุจูุช ุงูุตุฏููุ", a: "ุนุงุฆุดุฉ", char: "ุน" },
            { q: "ุฃูู ุณููุฑ ูู ุงูุฅุณูุงูุ", a: "ูุตุนุจ", char: "ู" },
            { q: "ุนุฏุฏ ุฃุฌุฒุงุก ุงููุฑุขูุ", a: "ุซูุงุซูู", char: "ุซ" },
            { q: "ูุจู ุงุจุชูุนู ุงูุญูุชุ", a: "ูููุณ", char: "ู" },
            { q: "ุฃูู ุงูุฎููุงุก ุงูุฑุงุดุฏููุ", a: "ุงุจูุจูุฑ", char: "ุง" },
            { q: "ูุฏููุฉ ูุทูู ุนูููุง ุทูุจุฉุ", a: "ุงููุฏููุฉ", char: "ุง" },
            { q: "ุนุฏุฏ ุงูุตููุงุช ุงูููุฑูุถุฉุ", a: "ุฎูุณ", char: "ุฎ" },
            { q: "ุงูุดูุฑ ุงูุฐู ูุฒู ููู ุงููุฑุขูุ", a: "ุฑูุถุงู", char: "ุฑ" },
            { q: "ูู ุจูู ุงููุนุจุฉ ูุน ุงุจููุ", a: "ุงุจุฑุงููู", char: "ุง" },
            { q: "ุงุณู ุฒูุฌุฉ ูุฑุนูู ุงููุคููุฉุ", a: "ุงุณูุง", char: "ุง" },
            { q: "ุงูุณูุฑุฉ ุงูุชู ุชุณูู ููุจ ุงููุฑุขูุ", a: "ูุณ", char: "ู" },
            { q: "ูู ุฃู ุนุงู ูุงูุช ุญุฌุฉ ุงููุฏุงุนุ", a: "ุนุงุดุฑ", char: "ุน" },
            { q: "ูู ูู ุณูู ุงููู ุงููุณูููุ", a: "ุฎุงูุฏ", char: "ุฎ" },
            { q: "ูู ูู ุฃููู ูุฐู ุงูุฃูุฉุ", a: "ุงุจูุนุจูุฏุฉ", char: "ุง" },
            { q: "ุงุณู ุบุงุฑ ุงููุญูุ", a: "ุญุฑุงุก", char: "ุญ" },
            { q: "ุงุณู ุบุงุฑ ุงููุฌุฑุฉุ", a: "ุซูุฑ", char: "ุซ" },
            { q: "ุฃุทูู ุณูุฑุฉ ูู ุงููุฑุขูุ", a: "ุงูุจูุฑุฉ", char: "ุง" },
            { q: "ุฃูุตุฑ ุณูุฑุฉ ูู ุงููุฑุขูุ", a: "ุงูููุซุฑ", char: "ุง" },
            { q: "ูุฑุถุนุฉ ุงูุฑุณูู ๏ทบุ", a: "ุญูููุฉ", char: "ุญ" },
            { q: "ุนู ุงูุฑุณูู ุงููููุจ ุจุฃุณุฏ ุงูููุ", a: "ุญูุฒุฉ", char: "ุญ" },
            { q: "ูู ูู ุงููุงุฑููุ", a: "ุนูุฑ", char: "ุน" },
            { q: "ุฃูู ูู ุฃุณูู ูู ุงูุฑุฌุงูุ", a: "ุงุจูุจูุฑ", char: "ุง" },
            { q: "ุฃูู ูู ุฃุณูู ูู ุงูุตุจูุงูุ", a: "ุนูู", char: "ุน" },
            { q: "ุฃูู ูู ุฃุณูู ูู ุงููุณุงุกุ", a: "ุฎุฏูุฌุฉ", char: "ุฎ" },
            { q: "ุฎุงุฒู ุงูุฌูุฉุ", a: "ุฑุถูุงู", char: "ุฑ" },
            { q: "ุงูุตุญุงุจู ุงูุฐู ุงูุชุฒ ูููุชู ุนุฑุด ุงูุฑุญููุ", a: "ุณุนุฏ", char: "ุณ" },
            { q: "ูู ุฃู ููู ุฎูู ุขุฏูุ", a: "ุงูุฌูุนุฉ", char: "ุง" },
            { q: "ุณูุฑุฉ ุฎุงููุฉ ูู ุงูุจุณููุฉุ", a: "ุงูุชูุจุฉ", char: "ุง" },
            { q: "ุงูุณูุฑุฉ ุงูุชู ุจูุง ุจุณููุชููุ", a: "ุงูููู", char: "ุง" },
            { q: "ุงูุตุญุงุจู ุงููููุจ ุจุชุฑุฌูุงู ุงููุฑุขูุ", a: "ุงุจู ุนุจุงุณ", char: "ุง" },
            { q: "ุงููุจู ุงูุฐู ูุงู ูู ุงูุญุฏูุฏุ", a: "ุฏุงูุฏ", char: "ุฏ" },
            { q: "ุงููุจู ุงูุฐู ุณุฎุฑุช ูู ุงูุฑูุงุญุ", a: "ุณูููุงู", char: "ุณ" },
            { q: "ุงููุจู ุงูุฐู ููุฑ ูู ุฒูุฌุชู ููู ุงูููุงูุฉุ", a: "ููุท", char: "ู" },
            { q: "ุฒูุฌุฉ ุงูุฑุณูู ุงููููุจุฉ ุจุฃู ุงููุณุงูููุ", a: "ุฒููุจ", char: "ุฒ" },
            { q: "ุงููุจูุฉ ุงูุฃููู ูููุณููููุ", a: "ุงููุฏุณ", char: "ุง" },
            { q: "ูุคุฐู ุงูุฑุณูู ูู ุงูุณูุงุกุ", a: "ุฌุจุฑูู", char: "ุฌ" },
            { q: "ุดุงุนุฑ ุงูุฑุณููุ", a: "ุญุณุงู", char: "ุญ" },
            { q: "ุญููุงู ูููุจ ุจููู ุงูุบุงุจุฉุ", a: "ุงูุงุณุฏ", char: "ุง" },
            { q: "ุฃุณุฑุน ุญููุงู ุจุฑูุ", a: "ุงูููุฏ", char: "ุง" },
            { q: "ุนุงุตูุฉ ุงูุณุนูุฏูุฉุ", a: "ุงูุฑูุงุถ", char: "ุง" },
            { q: "ุงูุดูุก ุงูุฐู ูููุง ุฒุงุฏ ููุตุ", a: "ุงูุนูุฑ", char: "ุง" },
            { q: "ุงููุนุฏู ุงูุณุงุฆูุ", a: "ุงูุฒุฆุจู", char: "ุง" },
            { q: "ุนุงุตูุฉ ููุณุทููุ", a: "ุงููุฏุณ", char: "ุง" },
            { q: "ุฃูุจุฑ ูุงุฑุงุช ุงูุนุงููุ", a: "ุงุณูุง", char: "ุง" },
            { q: "ุบุงุฒ ูุชููุณู ุงูุฅูุณุงูุ", a: "ุงูุงูุณุฌูู", char: "ุง" },
            { q: "ููุชุดู ุงูุฌุงุฐุจูุฉุ", a: "ูููุชู", char: "ู" },
            { q: "ุฃุทูู ููุฑ ูู ุงูุนุงููุ", a: "ุงูููู", char: "ุง" },
            { q: "ุงููููุจ ุงูุฃุญูุฑุ", a: "ุงููุฑูุฎ", char: "ุง" },
            { q: "ุตูุช ุงูุญุตุงูุ", a: "ุตููู", char: "ุต" },
            { q: "ุนูุณ ุชูุงุคูุ", a: "ุชุดุงุคู", char: "ุช" },
            { q: "ูุญุฏุฉ ููุงุณ ุงูุตูุชุ", a: "ุฏูุณูุจู", char: "ุฏ" },
            { q: "ุฃูุจุฑ ูุญูุท ูู ุงูุนุงููุ", a: "ุงููุงุฏู", char: "ุง" },
            { q: "ุฃุตุบุฑ ูุงุฑุฉ ูู ุงูุนุงููุ", a: "ุงุณุชุฑุงููุง", char: "ุง" },
            { q: "ุฏููุฉ ุงูููููู ุดููุฏุ", a: "ุงูุฌุฒุงุฆุฑ", char: "ุง" },
            { q: "ุนุงุตูุฉ ูุตุฑุ", a: "ุงููุงูุฑุฉ", char: "ุง" },
            { q: "ุนุงุตูุฉ ุงูุนุฑุงูุ", a: "ุจุบุฏุงุฏ", char: "ุจ" },
            { q: "ุนุงุตูุฉ ุงูุงุฑุฏูุ", a: "ุนูุงู", char: "ุน" },
            { q: "ุนุงุตูุฉ ุณูุฑูุงุ", a: "ุฏูุดู", char: "ุฏ" },
            { q: "ุนุงุตูุฉ ูุจูุงูุ", a: "ุจูุฑูุช", char: "ุจ" },
            { q: "ุนููุฉ ุงููููุชุ", a: "ุฏููุงุฑ", char: "ุฏ" },
            { q: "ุนููุฉ ุงูุณุนูุฏูุฉุ", a: "ุฑูุงู", char: "ุฑ" },
            { q: "ุนููุฉ ุงูุงูุงุฑุงุชุ", a: "ุฏุฑูู", char: "ุฏ" },
            { q: "ุฃูุจุฑ ุฏููุฉ ูุณุงุญุฉุ", a: "ุฑูุณูุง", char: "ุฑ" },
            { q: "ุฃูุจุฑ ุญููุงู ูู ุงูุนุงููุ", a: "ุงูุญูุช", char: "ุง" },
            { q: "ุทุงุฆุฑ ูุง ูุทูุฑุ", a: "ุงููุนุงูุฉ", char: "ุง" },
            { q: "ุญููุงู ูู ุฎุฑุทููุ", a: "ุงูููู", char: "ุง" },
            { q: "ุญููุงู ูุณูู ุณูููุฉ ุงูุตุญุฑุงุกุ", a: "ุงูุฌูู", char: "ุง" },
            { q: "ูู ุนุฏุฏ ุฃููุงู ููุณ ูุฒุญุ", a: "ุณุจุนุฉ", char: "ุณ" },
            { q: "ุดูุก ูู ุฃุณูุงู ููุง ูุนุถุ", a: "ุงููุดุท", char: "ุง" },
            { q: "ุจูุช ุงููููุ", a: "ูุฑูุฉ", char: "ู" },
            { q: "ุจูุช ุงููุญูุ", a: "ุฎููุฉ", char: "ุฎ" },
            { q: "ุตูุช ุงูุฃุณุฏุ", a: "ุฒุฆูุฑ", char: "ุฒ" },
            { q: "ุตูุช ุงูุฐุฆุจุ", a: "ุนูุงุก", char: "ุน" },
            { q: "ุตูุช ุงูุญูุงูุ", a: "ูุฏูู", char: "ู" },
            { q: "ุนุงุตูุฉ ุงูุทุงููุงุ", a: "ุฑููุง", char: "ุฑ" },
            { q: "ุนุงุตูุฉ ูุฑูุณุงุ", a: "ุจุงุฑูุณ", char: "ุจ" },
            { q: "ุนุงุตูุฉ ุจุฑูุทุงููุงุ", a: "ููุฏู", char: "ู" },
            { q: "ุนุงุตูุฉ ุงููุงููุงุ", a: "ุจุฑููู", char: "ุจ" },
            { q: "ุนุงุตูุฉ ุงุณุจุงููุงุ", a: "ูุฏุฑูุฏ", char: "ู" },
            { q: "ุนุงุตูุฉ ุงููุงุจุงูุ", a: "ุทูููู", char: "ุท" },
            { q: "ููุชุดู ุงููุตุจุงุญ ุงูููุฑุจุงุฆูุ", a: "ุงุฏูุณูู", char: "ุง" },
            { q: "ููุชุดู ุงููุงุชูุ", a: "ุจูู", char: "ุจ" },
            { q: "ููุชุดู ุงูุจูุณูููุ", a: "ููููุฌ", char: "ู" },
            { q: "ุงูุฐูุจ ุงูุฃุณูุฏ ููุ", a: "ุงูููุท", char: "ุง" },
            { q: "ุงูุฐูุจ ุงูุฃุจูุถ ููุ", a: "ุงููุทู", char: "ุง" },
            { q: "ูุฏููุฉ ุงูุถุจุงุจุ", a: "ููุฏู", char: "ู" },
            { q: "ุจูุฏ ุงูุฃูุฑุงูุงุชุ", a: "ูุตุฑ", char: "ู" },
            { q: "ุฃุทูู ูุจูู ูู ุงูุนุงููุ", a: "ุฎูููุฉ", char: "ุฎ" },
            { q: "ุฃุณุฑุน ุทุงุฆุฑ ูู ุงูุนุงููุ", a: "ุงูุดุงููู", char: "ุง" },
            { q: "ุญููุงู ููุงู ูุฅุญุฏู ุนูููู ููุชูุญุฉุ", a: "ุงูุฏูููู", char: "ุง" },
            { q: "ูู ููุจ ููุฃุฎุทุจูุทุ", a: "ุซูุงุซุฉ", char: "ุซ" },
            { q: "ุญููุงู ูุชููุณ ูู ูุคุฎุฑุชูุ", a: "ุงูุณูุญูุงุฉ", char: "ุง" },
            { q: "ูู ุนุฏุฏ ุฃุฑุฌู ุงูุนููุจูุชุ", a: "ุซูุงููุฉ", char: "ุซ" },
            { q: "ุงูุบุงุฒ ุงููุณุชุฎุฏู ูู ุงุทูุงุก ุงูุญุฑุงุฆูุ", a: "ุงููุฑุจูู", char: "ุง" },
            { q: "ุงูุนูุตุฑ ุงูููููุงุฆู ูููุงุกุ", a: "ููุฏุฑูุฌูู", char: "ู" },
            { q: "ุงููููุจ ุงูุฃูุฑุจ ููุดูุณุ", a: "ุนุทุงุฑุฏ", char: "ุน" },
            { q: "ุงููููุจ ุงูุฃุจุนุฏ ุนู ุงูุดูุณุ", a: "ูุจุชูู", char: "ู" },
            { q: "ุฃูุจุฑ ููุงูุจ ุงููุฌููุนุฉ ุงูุดูุณูุฉุ", a: "ุงููุดุชุฑู", char: "ุง" },
            { q: "ุฃุตุบุฑ ููุงูุจ ุงููุฌููุนุฉ ุงูุดูุณูุฉุ", a: "ุนุทุงุฑุฏ", char: "ุน" },
            { q: "ูู ูููุง ูู ุงูุณูุฉ ุงููุจูุณุฉุ", a: "ุณุชุฉูุณุชูู", char: "ุณ" },
            { q: "ูุง ูู ุงูุฏุงุกุ", a: "ุงููุฑุถ", char: "ุง" },
            { q: "ูุง ูู ุงูุฏูุงุกุ", a: "ุงูุนูุงุฌ", char: "ุง" },
            { q: "ุนูุณ ูููุฉ ูููุ", a: "ููุงุฑ", char: "ู" },
            { q: "ุนูุณ ูููุฉ ุงุจูุถุ", a: "ุงุณูุฏ", char: "ุง" },
            { q: "ุนูุณ ูููุฉ ุทูููุ", a: "ูุตูุฑ", char: "ู" },
            { q: "ุนูุณ ูููุฉ ุณูููุ", a: "ูุญูู", char: "ู" },
            { q: "ุนูุณ ูููุฉ ูููุ", a: "ุถุนูู", char: "ุถ" },
            { q: "ุนูุณ ูููุฉ ุณุฑูุนุ", a: "ุจุทูุก", char: "ุจ" },
            { q: "ูุฑุงุฏู ูููุฉ ุณุนูุฏุ", a: "ูุฑุญุงู", char: "ู" },
            { q: "ูุฑุงุฏู ูููุฉ ุญุฒููุ", a: "ูุฆูุจ", char: "ู" },
            { q: "ุฌูุน ูููุฉ ูุชุงุจุ", a: "ูุชุจ", char: "ู" },
            { q: "ุฌูุน ูููุฉ ูููุ", a: "ุงููุงู", char: "ุง" },
            { q: "ุฌูุน ูููุฉ ูุฏุฑุณุฉุ", a: "ูุฏุงุฑุณ", char: "ู" },
            { q: "ููุฑุฏ ูููุฉ ุทูุงุจุ", a: "ุทุงูุจ", char: "ุท" },
            { q: "ููุฑุฏ ูููุฉ ุนูููุ", a: "ุนูู", char: "ุน" },
            { q: "ููุฑุฏ ูููุฉ ูุณุงุฌุฏุ", a: "ูุณุฌุฏ", char: "ู" },
            { q: "ุฃูู ููุน ุจุฑุฌ ุงูููุ", a: "ุจุงุฑูุณ", char: "ุจ" },
            { q: "ุฃูู ุชูุน ุงููุนุจุฉุ", a: "ููุฉ", char: "ู" },
            { q: "ุฃูู ููุน ุงููุณุฌุฏ ุงููุจููุ", a: "ุงููุฏููุฉ", char: "ุง" },
            { q: "ุฃูู ููุน ุงููุณุฌุฏ ุงูุฃูุตูุ", a: "ููุณุทูู", char: "ู" },
            { q: "ุฃูู ููุน ุชูุซุงู ุงูุญุฑูุฉุ", a: "ุงูุฑููุง", char: "ุง" },
            { q: "ุฃูู ููุน ุชุงุฌ ูุญูุ", a: "ุงูููุฏ", char: "ุง" },
            { q: "ุฃูู ููุน ุณูุฑ ุงูุตููุ", a: "ุงูุตูู", char: "ุง" },
            { q: "ุฃูู ุชูุน ุงูุงูุฑุงูุงุชุ", a: "ูุตุฑ", char: "ู" },
            { q: "ุฃูู ุชูุน ุงูุจุชุฑุงุกุ", a: "ุงูุงุฑุฏู", char: "ุง" },
            { q: "ุฃูู ุชูุน ูุฏุงุฆู ุตุงูุญุ", a: "ุงูุณุนูุฏูุฉ", char: "ุง" },
            { q: "ุงุณู ุงูุนููุฉ ูู ูุทุฑุ", a: "ุฑูุงู", char: "ุฑ" },
            { q: "ุงุณู ุงูุนููุฉ ูู ุงูุจุญุฑููุ", a: "ุฏููุงุฑ", char: "ุฏ" },
            { q: "ุงุณู ุงูุนููุฉ ูู ุนูุงูุ", a: "ุฑูุงู", char: "ุฑ" },
            { q: "ุงุณู ุงูุนููุฉ ูู ูุตุฑุ", a: "ุฌููู", char: "ุฌ" },
            { q: "ุงุณู ุงูุนููุฉ ูู ุงูุฑูุจุงุ", a: "ููุฑู", char: "ู" },
            { q: "ุงุณู ุงูุนููุฉ ูู ุงูุฑููุงุ", a: "ุฏููุงุฑ", char: "ุฏ" },
            { q: "ุฃุณุฑุน ุงููุฎูููุงุช ุงูุจุญุฑูุฉุ", a: "ุงูุชููุฉ", char: "ุง" },
            { q: "ุฃุถุฎู ุญููุงู ูุง ููุงุฑูุ", a: "ุงูุญุจุงุฑ", char: "ุง" },
            { q: "ุญููุงู ูุชุบูุฑ ููููุ", a: "ุงูุญุฑุจุงุก", char: "ุง" },
            { q: "ุญููุงู ูุตูู ุฑูุถุงูุ", a: "ุงูุงูุนู", char: "ุง" },
            { q: "ุญููุงู ูุถุญู ูุงูุฅููุณุงูุ", a: "ุงูุถุจุน", char: "ุง" },
            { q: "ุญููุงู ููุณ ูู ุตูุชุ", a: "ุงูุฒุฑุงูุฉ", char: "ุง" },
            { q: "ุทุงุฆุฑ ููุฏ ููุง ูุจูุถุ", a: "ุงูุฎูุงุด", char: "ุง" },
            { q: "ูู ุนุฏุฏ ุงูุนููู ูููุญูุฉุ", a: "ุฎูุณ", char: "ุฎ" },
            { q: "ูู ุนุฏุฏ ุฃุฌูุญุฉ ุงููุญูุฉุ", a: "ุงุฑุจุนุฉ", char: "ุง" },
            { q: "ูู ุนุฏุฏ ุฃุฑุฌู ุงููููุฉุ", a: "ุณุชุฉ", char: "ุณ" },
            { q: "ูู ุนุฏุฏ ุฃุฑุฌู ุงูุนููุจูุชุ", a: "ุซูุงููุฉ", char: "ุซ" },
            { q: "ูุง ูู ุงูุฐูุจ ุงูุงุฒุฑูุ", a: "ุงููุงุก", char: "ุง" },
            { q: "ูุง ูู ุงูุฐูุจ ุงูุงุฎุถุฑุ", a: "ุงูููุญ", char: "ุง" },
            { q: "ูุง ูู ุงูุฐูุจ ุงูุงุจูุถุ", a: "ุงููุทู", char: "ุง" },
            { q: "ูุง ูู ุงูุฐูุจ ุงูุงุณูุฏุ", a: "ุงูููุท", char: "ุง" },
            { q: "ุฏููุฉ ุชูุน ูู ูุงุฑุชููุ", a: "ุชุฑููุง", char: "ุช" },
            { q: "ุงูุจุฑ ุฌุฒูุฑุฉ ูู ุงูุนุงููุ", a: "ุฌุฑูููุงูุฏ", char: "ุฌ" },
            { q: "ุงูุจุฑ ุจุญุฑ ูุบููุ", a: "ูุฒููู", char: "ู" },
            { q: "ุงุนูู ุฌุจู ูู ุงูุนุงููุ", a: "ุงููุฑุณุช", char: "ุง" },
            { q: "ุงุฎูุถ ููุทุฉ ุนูู ุงูุงุฑุถุ", a: "ุงูููุช", char: "ุง" },
            { q: "ุงุทูู ุฌุณุฑ ุจุญุฑูุ", a: "ููุฏ", char: "ู" },
            { q: "ุงูุจุฑ ุฏููุฉ ุนุฑุจูุฉุ", a: "ุงูุฌุฒุงุฆุฑ", char: "ุง" },
            { q: "ุงุตุบุฑ ุฏููุฉ ุนุฑุจูุฉุ", a: "ุงูุจุญุฑูู", char: "ุง" },
            { q: "ุงูุซุฑ ุงูุฏูู ุณูุงูุงุ", a: "ุงูุตูู", char: "ุง" },
            { q: "ุงูู ุงููุงุฑุงุช ุณูุงูุงุ", a: "ุงูุชุฑูุชููุง", char: "ุง" },
            { q: "ุงูู ูู ุตุนุฏ ููููุฑุ", a: "ุงุฑูุณุชุฑููุบ", char: "ุง" },
            { q: "ุงูู ูู ุงุฎุชุฑุน ุงูุทุงุฆุฑุฉุ", a: "ุฑุงูุช", char: "ุฑ" },
            { q: "ููุชุดู ุงูุฏูุฑุฉ ุงูุฏูููุฉุ", a: "ุงููููุณ", char: "ุง" },
            { q: "ูุคุณุณ ุนูู ุงูุฌุจุฑุ", a: "ุงูุฎูุงุฑุฒูู", char: "ุง" },
            { q: "ูุคุณุณ ุนูู ุงูุงุฌุชูุงุนุ", a: "ุฎูุฏูู", char: "ุฎ" },
            { q: "ูุคูู ูุชุงุจ ุงูุจุฎูุงุกุ", a: "ุงูุฌุงุญุธ", char: "ุง" },
            { q: "ุดุงุนุฑ ุงููููุ", a: "ุญุงูุธ", char: "ุญ" },
            { q: "ุงููุฑ ุงูุดุนุฑุงุกุ", a: "ุดููู", char: "ุด" },
            { q: "ุนููุฏ ุงูุงุฏุจ ุงูุนุฑุจูุ", a: "ุทู", char: "ุท" },
            { q: "ูููุจ ุงูุตุจุญุ", a: "ุงูุฒูุฑุฉ", char: "ุง" },
            { q: "ูุฌู ุงููุทุจุ", a: "ุงูุดูุงูู", char: "ุง" },
            { q: "ุนุฏุฏ ุงุณูุงู ุงูุงูุณุงู ุงูุจุงูุบุ", a: "ุงุซูุงู ูุซูุงุซูู", char: "ุง" },
            { q: "ุนุฏุฏ ุนุธุงู ุงูุงูุณุงูุ", a: "ูุฆุชุงู ูุณุชุฉ", char: "ู" },
            { q: "ุงูุนุถู ุงููุณุคูู ุนู ุงูุชุฐููุ", a: "ุงููุณุงู", char: "ุง" },
            { q: "ุงูุนุถู ุงููุณุคูู ุนู ุงูุดูุ", a: "ุงูุงูู", char: "ุง" },
            { q: "ุงูุนุถู ุงููุณุคูู ุนู ุงูุณูุนุ", a: "ุงูุงุฐู", char: "ุง" },
            { q: "ุงูุนุถู ุงููุณุคูู ุนู ุงูุจุตุฑุ", a: "ุงูุนูู", char: "ุง" },
            { q: "ุงูุจุฑ ุนุถู ูู ุงูุฌุณูุ", a: "ุงูุฌูุฏ", char: "ุง" },
            { q: "ุงููู ุนุถูุฉ ูู ุงูุฌุณูุ", a: "ุงููุณุงู", char: "ุง" }, 
            { q: "ุงูู ููุน ุงูููุจุ", a: "ุงููุณุงุฑ", char: "ุง" },
            { q: "ุณุงุฆู ุงูุญูุงุฉุ", a: "ุงูุฏู", char: "ุง" },
            { q: "ูุงุฐุง ูุบุทู ุฌุณู ุงูุทููุฑุ", a: "ุงูุฑูุด", char: "ุง" },
            { q: "ูุงุฐุง ูุบุทู ุฌุณู ุงูุงุณูุงูุ", a: "ุงููุดูุฑ", char: "ุง" },
            { q: "ูุงุฐุง ูุบุทู ุฌุณู ุงูุฏุจุ", a: "ุงููุฑู", char: "ุง" },
            { q: "ูุงุฐุง ูุบุทู ุฌุณู ุงูุฎุฑููุ", a: "ุงูุตูู", char: "ุง" },
            { q: "ุงุจู ุงูุจุดุฑุ", a: "ุงุฏู", char: "ุง" },
            { q: "ุงุจู ุงูุงูุจูุงุกุ", a: "ุงุจุฑุงููู", char: "ุง" },
            { q: "ุฎุงุชู ุงูุงูุจูุงุกุ", a: "ูุญูุฏ", char: "ู" },
            { q: "ูููู ุงูููุ", a: "ููุณู", char: "ู" },
            { q: "ุฑูุญ ุงูููุ", a: "ุนูุณู", char: "ุน" },
            { q: "ุฎููู ุงูููุ", a: "ุงุจุฑุงููู", char: "ุง" },
            { q: "ุงูุฐุจูุญุ", a: "ุงุณูุงุนูู", char: "ุง" },
            { q: "ุงููุจู ุงูุตุงุจุฑุ", a: "ุงููุจ", char: "ุง" },
            { q: "ุงููุจู ุงูุฌูููุ", a: "ููุณู", char: "ู" },
            { q: "ุงููุจู ุงููุฌุงุฑุ", a: "ุฒูุฑูุง", char: "ุฒ" },
            { q: "ุงููุจู ุงูุฎูุงุทุ", a: "ุงุฏุฑูุณ", char: "ุง" },
            { q: "ุงููุจู ุงูุญุฏุงุฏุ", a: "ุฏุงูุฏ", char: "ุฏ" },
            { q: "ุงูู ูู ุจูู ุงูุณุฌููุ", a: "ุนูู", char: "ุน" },
            { q: "ุงูู ูู ุฑูุจ ุงูุฎููุ", a: "ุงุณูุงุนูู", char: "ุง" },
            { q: "ุงูู ูู ูุชุจ ุจุงููููุ", a: "ุงุฏุฑูุณ", char: "ุง" },
            { q: "ุงูู ูู ูุงู ุงูุง ุจุนุฏุ", a: "ุฏุงูุฏ", char: "ุฏ" },
            { q: "ุณูุฏ ุงูุดูุฏุงุกุ", a: "ุญูุฒุฉ", char: "ุญ" },
            { q: "ุงููู ุงููุญูุ", a: "ุฌุจุฑูู", char: "ุฌ" },
            { q: "ููู ุงูููุชุ", a: "ุนุฒุฑุงุฆูู", char: "ุน" },
            { q: "ุญุงุฑุณ ุงูุฌูุฉุ", a: "ุฑุถูุงู", char: "ุฑ" },
            { q: "ุญุงุฑุณ ุงููุงุฑุ", a: "ูุงูู", char: "ู" },
            { q: "ูููุฎ ุงูุตูุฑุ", a: "ุงุณุฑุงููู", char: "ุง" },
            { q: "ุงูููุงู ุงููููู ุจุงููุทุฑุ", a: "ูููุงุฆูู", char: "ู" },
            { q: "ุงูู ูุนุฑูุฉ ูู ุงูุงุณูุงูุ", a: "ุจุฏุฑ", char: "ุจ" },
            { q: "ุขุฎุฑ ุบุฒูุฉ ููุฑุณููุ", a: "ุชุจูู", char: "ุช" },
            { q: "ูุงุชุญ ุงููุฏุณุ", a: "ุตูุงุญ", char: "ุต" },
            { q: "ูุงุชุญ ุงูุงูุฏูุณุ", a: "ุทุงุฑู", char: "ุท" },
            { q: "ูุงุชุญ ุงููุณุทูุทูููุฉุ", a: "ูุญูุฏ", char: "ู" },
            { q: "ูุงุชุญ ูุตุฑุ", a: "ุนูุฑู", char: "ุน" },
            { q: "ูุงุฆุฏ ุงููุฑุณ ูู ุงููุงุฏุณูุฉุ", a: "ุฑุณุชู", char: "ุฑ" },
            { q: "ูู ุนุฏุฏ ุงูุฎููุงุก ุงูุฑุงุดุฏููุ", a: "ุงุฑุจุนุฉ", char: "ุง" },
            { q: "ุนุงุตูุฉ ุงูุฎูุงูุฉ ุงูุงูููุฉุ", a: "ุฏูุดู", char: "ุฏ" },
            { q: "ุนุงุตูุฉ ุงูุฎูุงูุฉ ุงูุนุจุงุณูุฉุ", a: "ุจุบุฏุงุฏ", char: "ุจ" },
            { q: "ุนุงุตูุฉ ุงูุฏููุฉ ุงูุนุซูุงููุฉุ", a: "ุงุณูุงูุจูู", char: "ุง" },
            { q: "ูุฎุชุฑุน ุงูุฏููุงููุชุ", a: "ููุจู", char: "ู" },
            { q: "ูุฎุชุฑุน ุงูุฑุงุฏููุ", a: "ูุงุฑูููู", char: "ู" },
            { q: "ูุฎุชุฑุน ุงูุชููุฒูููุ", a: "ุจูุฑุฏ", char: "ุจ" },
            { q: "ููุชุดู ุงูุฑููุงุ", a: "ูููููุจุณ", char: "ู" },
            { q: "ููุชุดู ุทุฑูู ุงูููุฏุ", a: "ุฌุงููุง", char: "ุฌ" },
            { q: "ุงูู ุฑุงุฆุฏ ูุถุงุก ุนุฑุจูุ", a: "ุณูุทุงู", char: "ุณ" }
        ];

        // --- NEW Question Bank for Connect 4 (Ages 8-16) ---
        // ุจูู ุฃุณุฆูุฉ ุฌุฏูุฏ ููุนุจุฉ "ุฃุฑุจุนุฉ ุชุฑุจุญ" - ููุงุณุจ ููุฃุนูุงุฑ ูจ-ูกูฆ
        const c4QuestionBank = [
            { q: "ูู ุนุฏุฏ ุฑูุนุงุช ุตูุงุฉ ุงููุฌุฑุ", a: "ุฑูุนุชุงู" },
            { q: "ูู ุนุฏุฏ ุฑูุนุงุช ุตูุงุฉ ุงููุบุฑุจุ", a: "ุซูุงุซ" },
            { q: "ูู ุนุฏุฏ ุฑูุนุงุช ุตูุงุฉ ุงูุธูุฑุ", a: "ุงุฑุจุน" },
            { q: "ูู ุนุฏุฏ ุฃุฑูุงู ุงูุฅุณูุงูุ", a: "ุฎูุณุฉ" },
            { q: "ูู ุนุฏุฏ ุฃุฑูุงู ุงูุฅููุงูุ", a: "ุณุชุฉ" },
            { q: "ูู ูู ุฎุงุชู ุงูุฃูุจูุงุกุ", a: "ูุญูุฏ" },
            { q: "ูุง ูู ุงููุชุงุจ ุงูุฐู ูุฒู ุนูู ูุญูุฏ ๏ทบุ", a: "ุงููุฑุงู" },
            { q: "ูู ุฃู ุดูุฑ ูุตูู ุงููุณููููุ", a: "ุฑูุถุงู" },
            { q: "ูุง ูู ุงููุจูุฉ ุงูุชู ูุชุฌู ุฅูููุง ุงููุณููููุ", a: "ุงููุนุจุฉ" },
            { q: "ุฃูู ููุฏ ุงููุจู ูุญูุฏ ๏ทบุ", a: "ููุฉ" },
            { q: "ุฅูู ุฃูู ูุงุฌุฑ ุงููุจู ูุญูุฏ ๏ทบุ", a: "ุงููุฏููุฉ" },
            { q: "ูู ูู ุฃูู ุงูุจุดุฑุ", a: "ุงุฏู" },
            { q: "ูุง ูู ุงุณู ูุงูุฏ ุงููุจู ูุญูุฏ ๏ทบุ", a: "ุนุจุฏุงููู" },
            { q: "ูุง ูู ุงุณู ูุงูุฏุฉ ุงููุจู ูุญูุฏ ๏ทบุ", a: "ุงููุฉ" },
            { q: "ูู ูู ุงูุตุญุงุจู ุงููููุจ ุจุงูุตุฏููุ", a: "ุงุจูุจูุฑ" },
            { q: "ูุง ูู ุงูุตูุงุฉ ุงูุชู ููุณ ูููุง ุฑููุน ููุง ุณุฌูุฏุ", a: "ุงูุฌูุงุฒุฉ" },
            { q: "ูุง ูู ุงูุญููุงู ุงูุฐู ุงุฑุชุจุท ุจูุตุฉ ุฃุตุญุงุจ ุงููููุ", a: "ุงูููุจ" },
            { q: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ูุง ุชุจุฏุฃ ุจุจุณู ุงูููุ", a: "ุงูุชูุจุฉ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุจูู ุงูุณูููุฉุ", a: "ููุญ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุฃููู ูู ุงููุงุฑ ููู ูุญุชุฑูุ", a: "ุงุจุฑุงููู" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ูููุฉ ุงููู ุชููููุงูุ", a: "ููุณู" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ููุฏ ุจุฏูู ุฃุจุ", a: "ุนูุณู" },
            { q: "ูุง ูู ุงุณู ุฎุงุฒู ุงูุฌูุฉุ", a: "ุฑุถูุงู" },
            { q: "ูุง ูู ุงุณู ุฎุงุฒู ุงููุงุฑุ", a: "ูุงูู" },
            { q: "ูู ุนุฏุฏ ุงูุฎููุงุก ุงูุฑุงุดุฏููุ", a: "ุงุฑุจุนุฉ" },
            { q: "ูู ูู ูุคุฐู ุงูุฑุณููุ", a: "ุจูุงู" },
            { q: "ูุง ูู ุนุงุตูุฉ ุงูููููุฉ ุงูุนุฑุจูุฉ ุงูุณุนูุฏูุฉุ", a: "ุงูุฑูุงุถ" },
            { q: "ูุง ูู ุงูุนููุฉ ุงููุณุชุฎุฏูุฉ ูู ุงูุณุนูุฏูุฉุ", a: "ุฑูุงู" },
            { q: "ุฃูุจุฑ ูุงุฑุฉ ูู ุงูุนุงููุ", a: "ุงุณูุง" },
            { q: "ุฃุตุบุฑ ูุงุฑุฉ ูู ุงูุนุงููุ", a: "ุงุณุชุฑุงููุง" },
            { q: "ูุง ูู ุฃุณุฑุน ุญููุงู ุจุฑูุ", a: "ุงูููุฏ" },
            { q: "ูุง ูู ููู ุงูุบุงุจุฉุ", a: "ุงูุงุณุฏ" },
            { q: "ูุง ูู ุงูุทุงุฆุฑ ุงูุฐู ูุง ูุทูุฑ ููู ุฑูุจุฉ ุทูููุฉุ", a: "ุงููุนุงูุฉ" },
            { q: "ุดูุก ุชุดุชุฑูู ุจูุงูู ููุง ุชุฏุฎูู ุฏุงุฑูุ", a: "ุงูุณูุงุฑุฉ" }, // ูุบุฒ ุณูู: ุงูุณูุงุฑุฉ (ูุฌุงุฒู) ุฃู ูุตุญุญ ูู (ุงููููุ ูุง ุตุนุจ).. ูุบูุฑู
            { q: "ุดูุก ูููุง ุฃุฎุฐุช ููู ูุจุฑุ", a: "ุงูุญูุฑุฉ" },
            { q: "ุดูุก ูู ุฃุณูุงู ููุง ูุนุถุ", a: "ุงููุดุท" },
            { q: "ุฃุฎุช ุฎุงูุชู ูููุณุช ุฎุงูุชูุ ูู ุชูููุ", a: "ุงูู" },
            { q: "ูุง ูู ุงูุดูุก ุงูุฐู ููุชุจ ููุง ููุฑุฃุ", a: "ุงูููู" },
            { q: "ูุง ูู ุงูุจูุช ุงูุฐู ููุณ ููู ุฃุจูุงุจ ููุง ููุงูุฐุ", a: "ุงูุดุนุฑ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุงุจุชูุนู ุงูุญูุชุ", a: "ูููุณ" },
            { q: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ุชุนุฏู ุซูุซ ุงููุฑุขูุ", a: "ุงูุงุฎูุงุต" },
            { q: "ูุง ูู ุฃุนุธู ุขูุฉ ูู ุงููุฑุขูุ", a: "ุงููุฑุณู" },
            { q: "ูู ุฃู ููู ุฎูู ุงููู ุขุฏูุ", a: "ุงูุฌูุนุฉ" },
            { q: "ูุง ูู ุงุณู ุฌุฏ ุงููุจู ูุญูุฏ ๏ทบุ", a: "ุนุจุฏุงููุทูุจ" },
            { q: "ูู ูู ุฒูุฌุฉ ุงููุจู ุงูุฃูููุ", a: "ุฎุฏูุฌุฉ" },
            { q: "ูู ูู ุงุจูุฉ ุงููุจู ุฒูุฌุฉ ุนูู ุจู ุฃุจู ุทุงูุจุ", a: "ูุงุทูุฉ" },
            { q: "ูุง ูู ุงุณู ุนู ุงููุจู ุงูุฐู ููููุ", a: "ุงุจูุทุงูุจ" },
            { q: "ูุง ูู ุงูุฑูู ุงูุซุงูู ูู ุฃุฑูุงู ุงูุฅุณูุงูุ", a: "ุงูุตูุงุฉ" },
            { q: "ูุง ูู ุงูุฑูู ุงูุซุงูุซ ูู ุฃุฑูุงู ุงูุฅุณูุงูุ", a: "ุงูุฒูุงุฉ" },
            { q: "ูุง ูู ุงูุฑูู ุงูุฑุงุจุน ูู ุฃุฑูุงู ุงูุฅุณูุงูุ", a: "ุงูุตูู" },
            { q: "ูุง ูู ุงูุฑูู ุงูุฎุงูุณ ูู ุฃุฑูุงู ุงูุฅุณูุงูุ", a: "ุงูุญุฌ" },
            { q: "ูุง ูู ุงูุตูุงุฉ ุงููุณุทูุ", a: "ุงูุนุตุฑ" },
            { q: "ูุง ูู ุฃูู ูุนุฑูุฉ ูู ุงูุฅุณูุงูุ", a: "ุจุฏุฑ" },
            { q: "ูู ูู ุณูู ุงููู ุงููุณูููุ", a: "ุฎุงูุฏ" },
            { q: "ูู ูู ุงููุงุฑููุ", a: "ุนูุฑ" },
            { q: "ูู ูู ุฐู ุงูููุฑููุ", a: "ุนุซูุงู" },
            { q: "ูู ูู ุฃุณุฏ ุงูููุ", a: "ุญูุฒุฉ" },
            { q: "ูู ุณูุฉ ุงุณุชูุฑ ูุฒูู ุงููุฑุขูุ", a: "ุซูุงุซุฉูุนุดุฑูู" },
            { q: "ูุง ูู ุงูุดูุฑ ุงูุฐู ูุฒู ููู ุงููุฑุขูุ", a: "ุฑูุถุงู" },
            { q: "ูุง ูู ุงููููุฉ ุงูุชู ูู ุฎูุฑ ูู ุฃูู ุดูุฑุ", a: "ุงููุฏุฑ" },
            { q: "ูุง ูู ุงุณู ุงูุฌุจู ุงูุฐู ุนููู ุบุงุฑ ุญุฑุงุกุ", a: "ุงูููุฑ" },
            { q: "ูุง ูู ุงุณู ุงูุบุงุฑ ุงูุฐู ุงุฎุชุจุฃ ููู ุงูุฑุณูู ูุฃุจู ุจูุฑุ", a: "ุซูุฑ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุตุจุฑ ุนูู ุงููุฑุถุ", a: "ุงููุจ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ูุงู ูููุงูุ", a: "ุณูููุงู" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ูุงู ูู ุงูุญุฏูุฏุ", a: "ุฏุงูุฏ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุฑูุนู ุงููู ุฅูููุ", a: "ุนูุณู" },
            { q: "ุฃูู ูู ุขูู ูู ุงูุฑุฌุงูุ", a: "ุงุจูุจูุฑ" },
            { q: "ุฃูู ูู ุขูู ูู ุงููุณุงุกุ", a: "ุฎุฏูุฌุฉ" },
            { q: "ุฃูู ูู ุขูู ูู ุงูุตุจูุงูุ", a: "ุนูู" },
            { q: "ูุง ูู ุงูุทุงุฆุฑ ุงูุฐู ุชููู ูุน ุณูููุงูุ", a: "ุงููุฏูุฏ" },
            { q: "ูุง ูู ุงูุญุดุฑุฉ ุงูุชู ุชูููุช ูู ุงููุฑุขูุ", a: "ุงููููุฉ" },
            { q: "ูุง ูู ุงูุญููุงู ุงูุฐู ุฎููู ุงููู ูู ูุงูุฉุ", a: "ุงูุฌูู" }, // ุณุคุงู ููุชุนุฏูู: ุงููุงูุฉ ูู ุฃูุซู ุงูุฌูู
            { q: "ูุง ูู ุฃูุจุฑ ุญููุงู ูู ุงูุจุญุฑุ", a: "ุงูุญูุช" },
            { q: "ูุง ูู ุงูุฐูุจ ุงูุฃุณูุฏุ", a: "ุงูููุท" },
            { q: "ูุง ูู ุนุงุตูุฉ ูุตุฑุ", a: "ุงููุงูุฑุฉ" },
            { q: "ูุง ูู ุนุงุตูุฉ ุงูุฃุฑุฏูุ", a: "ุนูุงู" },
            { q: "ูุง ูู ุนุงุตูุฉ ุงููููุชุ", a: "ุงููููุช" },
            { q: "ูุง ูู ุนุงุตูุฉ ุงูุจุญุฑููุ", a: "ุงูููุงูุฉ" },
            { q: "ูุง ูู ุนุงุตูุฉ ูุทุฑุ", a: "ุงูุฏูุญุฉ" },
            { q: "ูุง ูู ุนุงุตูุฉ ุงูุฅูุงุฑุงุชุ", a: "ุงุจูุธุจู" },
            { q: "ุฏููุฉ ุฎููุฌูุฉ ุชุชููู ูู ุฌุฒุฑุ", a: "ุงูุจุญุฑูู" },
            { q: "ูู ูู ูุฎุชุฑุน ุงููุตุจุงุญุ", a: "ุงุฏูุณูู" },
            { q: "ูู ูู ููุชุดู ุงูุฌุงุฐุจูุฉุ", a: "ูููุชู" },
            { q: "ูุง ูู ุงูุณุงุฆู ุงูุฐู ูุง ููู ูู ููุง ุทุนู ููุง ุฑุงุฆุญุฉุ", a: "ุงููุงุก" },
            { q: "ูู ุนุฏุฏ ุฃูุงู ุงูุฃุณุจูุนุ", a: "ุณุจุนุฉ" },
            { q: "ูู ุนุฏุฏ ุณุงุนุงุช ุงููููุ", a: "ุงุฑุจุน ูุนุดุฑูู" },
            { q: "ูุง ูู ุนูุณ ุฃุจูุถุ", a: "ุงุณูุฏ" },
            { q: "ูุง ูู ุนูุณ ุทูููุ", a: "ูุตูุฑ" },
            { q: "ูุง ูู ุนูุณ ุณูููุ", a: "ูุญูู" },
            { q: "ูุง ูู ูุฑุงุฏู ูููุฉ (ููุดู)ุ", a: "ูุณูุฑ" },
            { q: "ูุง ูู ุฌูุน ูููุฉ (ููุฏ)ุ", a: "ุงููุงุฏ" },
            { q: "ูุง ูู ููุฑุฏ ูููุฉ (ูุฏุงุฑุณ)ุ", a: "ูุฏุฑุณุฉ" },
            { q: "ูุง ูู ุตูุช ุงููุทุฉุ", a: "ููุงุก" },
            { q: "ูุง ูู ุตูุช ุงูููุจุ", a: "ูุจุงุญ" },
            { q: "ูุง ูู ุตูุช ุงูุนุตููุฑุ", a: "ุชุบุฑูุฏ" },
            { q: "ูู ุฃู ูุตู ุชุชุณุงูุท ุฃูุฑุงู ุงูุดุฌุฑุ", a: "ุงูุฎุฑูู" },
            { q: "ูู ุฃู ูุตู ูุฐูุจ ููุจุญุฑุ", a: "ุงูุตูู" },
            { q: "ูู ุฃู ูุตู ููุฒู ุงููุทุฑุ", a: "ุงูุดุชุงุก" },
            { q: "ูู ุฃู ูุตู ุชุชูุชุญ ุงูุฒููุฑุ", a: "ุงูุฑุจูุน" },
            { q: "ูุง ูู ุงุณู ูุงูุฏุฉ ุงุณูุงุนูู ุนููู ุงูุณูุงูุ", a: "ูุงุฌุฑ" },
            { q: "ูุง ูู ุงุณู ูุงูุฏุฉ ุงุณุญุงู ุนููู ุงูุณูุงูุ", a: "ุณุงุฑุฉ" },
            { q: "ุฃูู ููุฌุฏ ุงููุณุฌุฏ ุงูุฃูุตูุ", a: "ููุณุทูู" },
            { q: "ุฃูู ููุฌุฏ ุงููุณุฌุฏ ุงูุญุฑุงูุ", a: "ููุฉ" },
            { q: "ุฃูู ููุฌุฏ ุงููุณุฌุฏ ุงููุจููุ", a: "ุงููุฏููุฉ" },
            { q: "ูุง ูู ุฃูู ูุณุฌุฏ ุจูู ูู ุงูุฅุณูุงูุ", a: "ูุจุงุก" },
            { q: "ูู ุณูุฉ ุตุงู ุงูุฑุณูู ุฑูุถุงูุ", a: "ุชุณุน" },
            { q: "ูู ูู ุนู ุงูุฑุณูู ุงูุฐู ุฑูุถ ุงูุฅุณูุงูุ", a: "ุงุจูููุจ" },
            { q: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ุชุณูู ุนุฑูุณ ุงููุฑุขูุ", a: "ุงูุฑุญูู" },
            { q: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ุชุณูู ููุจ ุงููุฑุขูุ", a: "ูุณ" },
            { q: "ูุง ูู ุฃูุตุฑ ุณูุฑุฉ ูู ุงููุฑุขูุ", a: "ุงูููุซุฑ" },
            { q: "ูุง ูู ุฃุทูู ุณูุฑุฉ ูู ุงููุฑุขูุ", a: "ุงูุจูุฑุฉ" },
            { q: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ููุณ ูููุง ุญุฑู ุงููููุ", a: "ุงูููุซุฑ" },
            { q: "ูุง ูู ุงูุดูุก ุงูุฐู ุฎููู ุงููู ูุงุณุชุนุธูู (ููุฏ..)ุ", a: "ุงููุณุงุก" },
            { q: "ูุง ูู ุงูุดูุก ุงูุฐู ุฎููู ุงููู ูุฃููุฑู (ุตูุช..)ุ", a: "ุงูุญููุฑ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ููุจ ุจู ูููู ุงูููุ", a: "ููุณู" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ููุจ ุจู ุฎููู ุงูููุ", a: "ุงุจุฑุงููู" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ููุจ ุจู ุฑูุญ ุงูููุ", a: "ุนูุณู" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ููุจ ุจู ุฐู ุงููููุ", a: "ูููุณ" },
            { q: "ูู ุนุฏุฏ ุฃุจูุงุจ ุงูุฌูุฉุ", a: "ุซูุงููุฉ" },
            { q: "ูู ุนุฏุฏ ุฃุจูุงุจ ุงููุงุฑุ", a: "ุณุจุนุฉ" },
            { q: "ูุง ูู ุงุณู ุฎุงุฒู ุงููุงุฑุ", a: "ูุงูู" },
            { q: "ูุง ูู ุงุณู ุฎุงุฒู ุงูุฌูุฉุ", a: "ุฑุถูุงู" },
            { q: "ูุง ูู ุงูุฑูู ุงูุฃูู ูู ุฃุฑูุงู ุงูุฅุณูุงูุ", a: "ุงูุดูุงุฏุชุงู" },
            { q: "ูุจู ุฎููู ุงููู ูู ุทููุ", a: "ุงุฏู" },
            { q: "ูุจู ุฎููู ุงููู ูู ูุงุฑุ", a: "ุงุจููุณ" }, // ุชุตุญูุญ: ุงุจููุณ ููุณ ูุจู
            { q: "ูุฎูููุงุช ุฎููุช ูู ููุฑุ", a: "ุงูููุงุฆูุฉ" },
            { q: "ูุฎูููุงุช ุฎููุช ูู ูุงุฑุ", a: "ุงูุฌู" },
            { q: "ูู ูู ุงูููู ุงููููู ุจุงููุญูุ", a: "ุฌุจุฑูู" },
            { q: "ูู ูู ุงูููู ุงููููู ุจุงูููุฎ ูู ุงูุตูุฑุ", a: "ุงุณุฑุงููู" },
            { q: "ูู ูู ุงูููู ุงููููู ุจูุจุถ ุงูุฃุฑูุงุญุ", a: "ุนุฒุฑุงุฆูู" }, // ุฃู ููู ุงูููุช
            { q: "ูู ูู ุงูููู ุงููููู ุจุงููุทุฑุ", a: "ูููุงุฆูู" },
            { q: "ูุง ูู ุงูุตูุงุฉ ุงูุชู ุชุตูู ูุทูุจ ุงููุทุฑุ", a: "ุงูุงุณุชุณูุงุก" },
            { q: "ูุง ูู ุงูุตูุงุฉ ุงูุชู ุชุตูู ุนูุฏ ูุณูู ุงูุดูุณุ", a: "ุงููุณูู" },
            { q: "ูุง ูู ุงูุตูุงุฉ ุงูุชู ุชุตูู ุนูุฏ ุฎุณูู ุงูููุฑุ", a: "ุงูุฎุณูู" },
            { q: "ูุง ูู ุงูุฐูุฑ ุงูุฐู ููุงู ุนูุฏ ุงููููุ", a: "ุงูุงุฐูุงุฑ" },
            { q: "ุจุฃู ูุฏ ูุฃููุ", a: "ุงููููู" },
            { q: "ุจุฃู ุฑุฌู ูุฏุฎู ุงููุณุฌุฏุ", a: "ุงููููู" },
            { q: "ุจุฃู ุฑุฌู ูุฎุฑุฌ ูู ุงููุณุฌุฏุ", a: "ุงููุณุงุฑ" },
            { q: "ุจุฃู ุฑุฌู ูุฏุฎู ุงูุญูุงูุ", a: "ุงููุณุงุฑ" },
            { q: "ุจุฃู ุฑุฌู ูุฎุฑุฌ ูู ุงูุญูุงูุ", a: "ุงููููู" },
            { q: "ูุงุฐุง ูููู ุนูุฏ ุงูุนุทุณุ", a: "ุงูุญูุฏููู" },
            { q: "ูุงุฐุง ูุฑุฏ ุงูุนุงุทุณ ุฅุฐุง ุดูุชุ", a: "ููุฏููู" },
            { q: "ูุง ูู ุงูุดูุฑ ุงูุฐู ูุฃุชู ุจุนุฏ ุฑูุถุงูุ", a: "ุดูุงู" },
            { q: "ูุง ูู ุงูุดูุฑ ุงูุฐู ููู ุงูุญุฌุ", a: "ุฐูุงูุญุฌุฉ" },
            { q: "ูุง ูู ุงูุนูุฏ ุงูุฐู ูุฃุชู ุจุนุฏ ุฑูุถุงูุ", a: "ุงููุทุฑ" },
            { q: "ูุง ูู ุงูุนูุฏ ุงูุฐู ูุฃุชู ูู ุงูุญุฌุ", a: "ุงูุงุถุญู" },
            { q: "ูู ุนุฏุฏ ุชูุจูุฑุงุช ุตูุงุฉ ุงูุฌูุงุฒุฉุ", a: "ุงุฑุจุน" },
            { q: "ูู ูู ุตูุงุฉ ุงูุฌูุงุฒุฉ ุฑููุนุ", a: "ูุง" },
            { q: "ูู ูู ุตูุงุฉ ุงูุฌูุงุฒุฉ ุณุฌูุฏุ", a: "ูุง" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ูุงูุช ูุนุฌุฒุชู ุงูุนุตุงุ", a: "ููุณู" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ูุงูุช ูุนุฌุฒุชู ุงููุงูุฉุ", a: "ุตุงูุญ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ูุงูุช ูุนุฌุฒุชู ุงุญูุงุก ุงูููุชูุ", a: "ุนูุณู" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุงูุดู ูู ุงูููุฑุ", a: "ูุญูุฏ" },
            { q: "ูุง ูู ุงุณู ูุงูุฉ ุตุงูุญุ", a: "ุงููุงูุฉ" },
            { q: "ูู ุฃู ูุฏููุฉ ููุน ุงููุณุฌุฏ ุงูุฅุจุฑุงููููุ", a: "ุงูุฎููู" },
            { q: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ุฐูุฑุช ูููุง ุงูุจุณููุฉ ูุฑุชููุ", a: "ุงูููู" },
            { q: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ุชุณูู ุงููุงุถุญุฉุ", a: "ุงูุชูุจุฉ" },
            { q: "ูุง ูู ุงูุดุฌุฑุฉ ุงูููุนููุฉ ูู ุงููุฑุขูุ", a: "ุงูุฒููู" },
            { q: "ูุง ูู ุงููุงููุฉ ุงูุชู ุฐูุฑุช ูู ุงููุฑุขู (ูุงูุชูู..)ุ", a: "ุงูุชูู" },
            { q: "ูุง ูู ุงูุญููุงู ุงูุฐู ุฐูุฑ ูุน ุฃุตุญุงุจ ุงููููุ", a: "ุงูููุจ" },
            { q: "ูู ูุจุซ ุฃุตุญุงุจ ุงูููู ูู ูููููุ", a: "ุซูุงุซูุงุฆุฉ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุฃูุฑู ุงููู ุจุจูุงุก ุงููุนุจุฉุ", a: "ุงุจุฑุงููู" },
            { q: "ูู ุณุงุนุฏ ุฅุจุฑุงููู ูู ุจูุงุก ุงููุนุจุฉุ", a: "ุงุณูุงุนูู" },
            { q: "ูุง ูู ุงุณู ุฃู ููุณูุ", a: "ูููุงุจุฏ" }, // ูุฏ ูููู ุตุนุจุ ูุจุฏูู
            { q: "ูู ููู ูุฑูู ุนูููุง ุงูุณูุงูุ", a: "ุฒูุฑูุง" },
            { q: "ูุง ูู ุงุณู ูุงูุฏุฉ ุนูุณู ุนููู ุงูุณูุงูุ", a: "ูุฑูู" },
            { q: "ูู ุนุฏุฏ ุฃููู ุงูุนุฒู ูู ุงูุฑุณูุ", a: "ุฎูุณุฉ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุฃุฑุณู ุฅูู ููู ุนุงุฏุ", a: "ููุฏ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุฃุฑุณู ุฅูู ููู ุซููุฏุ", a: "ุตุงูุญ" },
            { q: "ูู ูู ุงููุจู ุงูุฐู ุฃุฑุณู ุฅูู ูุฏููุ", a: "ุดุนูุจ" },
            { q: "ุฃุทูู ุขูุฉ ูู ุงููุฑุขู ูู ุขูุฉุ", a: "ุงูุฏูู" },
            { q: "ูุง ูู ุงูุณูุฑุฉ ุงูุชู ุชุญูู ุขูุฉ ุงููุฑุณูุ", a: "ุงูุจูุฑุฉ" },
            { q: "ูุง ูู ุงูุญุดุฑุฉ ุงูุชู ุชุตูุน ุงูุนุณูุ", a: "ุงููุญูุฉ" },
            { q: "ูุง ูู ุงูุญููุงู ุงูุฐู ูุนุทููุง ุงูุญููุจุ", a: "ุงูุจูุฑุฉ" },
            { q: "ูุง ูู ุงูุญููุงู ุงูุฐู ูุญุฑุซ ุงูุฃุฑุถุ", a: "ุงูุซูุฑ" },
            { q: "ูุง ูู ุงูุญููุงู ุงูุฐู ูุณูู ุงููุงูุฑุ", a: "ุงูุซุนูุจ" },
            { q: "ูุง ูู ุงูุญููุงู ุงูุฐู ูุบุทู ุฌุณูู ุงูุดููุ", a: "ุงููููุฐ" }
        ];

        // --- HELPER: Intelligent Normalization & Matching ---
        function normalizeText(text) {
            if(!text) return "";
            return text.trim()
                .replace(/[ุฃุฅุข]/g, 'ุง')
                .replace(/ุฉ$/g, 'ู')
                .replace(/ู$/g, 'ู')
                .replace(/[\u064B-\u065F]/g, '') // remove tashkeel
                .replace(/\s+/g, ' ');
        }

        // Levenshtein Distance for typos
        function getEditDistance(a, b) {
            if(a.length === 0) return b.length; 
            if(b.length === 0) return a.length; 
            var matrix = [];
            for(var i = 0; i <= b.length; i++) matrix[i] = [i];
            for(var j = 0; j <= a.length; j++) matrix[0][j] = j;
            for(var i = 1; i <= b.length; i++){
                for(var j = 1; j <= a.length; j++){
                    if(b.charAt(i-1) == a.charAt(j-1)) matrix[i][j] = matrix[i-1][j-1];
                    else matrix[i][j] = Math.min(matrix[i-1][j-1] + 1, Math.min(matrix[i][j-1] + 1, matrix[i-1][j] + 1));
                }
            }
            return matrix[b.length][a.length];
        }

        function isSmartMatch(userInput, targetAnswer) {
            const u = normalizeText(userInput);
            const t = normalizeText(targetAnswer);
            
            if (u === "") return false;
            if (u === t) return true;
            
            const userWords = u.split(" ");
            if (userWords.includes(t)) return true;
            
            if (t.includes(u) && u.length > 2) return true;
            if (u.includes(t) && t.length > 2) return true;

            const dist = getEditDistance(u, t);
            const allowedErrors = t.length > 5 ? 2 : 1;
            if (dist <= allowedErrors) return true;
            
            return false;
        }

        function showScreen(id) {
            ['screen-menu', 'screen-crossword', 'screen-hexagon', 'screen-connect4', 'screen-win', 'round-win-modal'].forEach(s => {
                document.getElementById(s).classList.add('hidden');
            });
            document.getElementById(id).classList.remove('hidden');
        }

        function launchGame(type) {
            playSound('click');
            const t1 = document.getElementById('g-team1').value.trim() || "ุงููุฑูู ุงูุฃุฎุถุฑ";
            const t2 = document.getElementById('g-team2').value.trim() || "ุงููุฑูู ุงูุฃุญูุฑ";
            gState.team1 = t1;
            gState.team2 = t2;
            gState.currentGame = type;

            if (type === 'crossword') initCrossword();
            else if (type === 'hexagon') initHexagon();
            else initConnect4();
        }

        function goHome() {
            playSound('click');
            showScreen('screen-menu');
            clearInterval(cwState.timerInterval);
            clearInterval(hexState.timerInterval);
            clearInterval(c4State.timerInterval);
        }

        function showWin(winnerName) {
            playSound('win');
            document.getElementById('winner-name').innerText = winnerName;
            showScreen('screen-win');
        }

        // --- CROSSWORD LOGIC (Unchanged) ---
        let cwState = {
            stage: 1, score1: 0, score2: 0, hints1: 5, hints2: 5, turn: 1,
            questions: [], currentQ: null, userAns: [], timer: 60, timerInterval: null
        };

        function initCrossword() {
            cwState = {
                stage: 1, score1: 0, score2: 0, hints1: 5, hints2: 5, turn: 1,
                questions: shuffleArray([...questionBank]).slice(0, 10),
                currentQ: null, userAns: [], timer: 60, timerInterval: null
            };
            document.getElementById('cw-t1-name').innerText = gState.team1;
            document.getElementById('cw-t2-name').innerText = gState.team2;
            updateCwUI();
            showScreen('screen-crossword');
            loadCwStage();
        }

        function loadCwStage() {
            if (cwState.stage > 10) {
                let winner = cwState.score1 > cwState.score2 ? gState.team1 : gState.team2;
                if (cwState.score1 === cwState.score2) winner = "ุชุนุงุฏู!";
                showWin(winner);
                return;
            }
            clearInterval(cwState.timerInterval);
            cwState.timer = 60;
            cwState.userAns = [];
            cwState.currentQ = cwState.questions[cwState.stage - 1];
            document.getElementById('cw-stage').innerText = cwState.stage;
            document.getElementById('cw-question').innerText = cwState.currentQ.q;
            document.getElementById('cw-feedback').innerText = "";
            renderCwGrid();
            renderCwKeyboard();
            updateCwTurnUI();
            startCwTimer();
        }

        function startCwTimer() {
            document.getElementById('cw-timer').innerText = cwState.timer;
            cwState.timerInterval = setInterval(() => {
                cwState.timer--;
                const timerEl = document.getElementById('cw-timer');
                timerEl.innerText = cwState.timer;
                
                if(cwState.timer <= 10 && cwState.timer > 0) {
                    timerEl.classList.add('bg-red-600', 'animate-pulse');
                    timerEl.classList.remove('bg-[#1a472a]');
                    if(cwState.timer === 10 || cwState.timer === 5 || cwState.timer === 1) {
                        playSound('warning');
                    }
                } else if(cwState.timer > 10) {
                    timerEl.classList.remove('bg-red-600', 'animate-pulse');
                    timerEl.classList.add('bg-[#1a472a]');
                }
                
                if(cwState.timer <= 0) {
                    clearInterval(cwState.timerInterval);
                    cwSwitchTurn(true);
                }
            }, 1000);
        }

        function renderCwGrid() {
            const grid = document.getElementById('cw-grid');
            grid.innerHTML = '';
            const ans = cwState.currentQ.a;
            for(let i=0; i<ans.length; i++) {
                const box = document.createElement('div');
                box.className = "letter-box w-10 h-10 md:w-12 md:h-12 border-2 border-gray-300 rounded-lg flex items-center justify-center text-xl font-bold bg-white text-gray-400";
                if(cwState.userAns[i]) {
                    box.innerText = cwState.userAns[i];
                    box.classList.add('filled', 'text-gray-900');
                }
                grid.appendChild(box);
            }
        }

        function renderCwKeyboard() {
            const kb = document.getElementById('cw-keyboard');
            kb.innerHTML = '';
            let pool = cwState.currentQ.a.split('');
            const extras = "ุงุจุชุซุฌุญุฎุฏุฐุฑุฒุณุดุตุถุทุธุนุบููููููููู";
            while (pool.length < 14) pool.push(extras[Math.floor(Math.random() * extras.length)]);
            pool = shuffleArray(pool);
            pool.forEach(char => {
                const btn = document.createElement('button');
                btn.innerText = char;
                btn.className = "h-12 bg-white border border-gray-200 rounded-lg shadow-sm hover:bg-green-50 font-bold text-lg btn-hover text-gray-700";
                btn.onclick = () => cwInput(char);
                kb.appendChild(btn);
            });
        }

        function cwInput(char) {
            if(cwState.userAns.length < cwState.currentQ.a.length) {
                playSound('click');
                cwState.userAns.push(char);
                renderCwGrid();
                if(cwState.userAns.length === cwState.currentQ.a.length) checkCwAnswer();
            }
        }

        function cwBackspace() {
            if(cwState.userAns.length > 0) {
                playSound('click');
                cwState.userAns.pop();
                renderCwGrid();
                document.getElementById('cw-feedback').innerText = "";
            }
        }

        function checkCwAnswer() {
            const input = normalizeText(cwState.userAns.join(''));
            const target = normalizeText(cwState.currentQ.a);

            if(input === target) {
                clearInterval(cwState.timerInterval);
                playSound('correct');
                document.querySelectorAll('.letter-box').forEach(b => b.classList.add('correct'));
                document.getElementById('cw-feedback').innerText = "ุฃุญุณูุช! ุฅุฌุงุจุฉ ุตุญูุญุฉ";
                document.getElementById('cw-feedback').className = "text-green-600 font-bold h-6 mb-2";
                if(cwState.turn === 1) cwState.score1 += 10; else cwState.score2 += 10;
                updateCwUI();
                setTimeout(() => {
                    cwState.stage++;
                    cwState.turn = cwState.stage % 2 !== 0 ? 1 : 2; 
                    loadCwStage();
                }, 1500);
            } else {
                playSound('wrong');
                document.querySelectorAll('.letter-box').forEach(b => b.classList.add('wrong'));
                document.getElementById('cw-feedback').innerText = "ุฎุทุฃ! ุงูุชูุงู ุงูุฏูุฑ...";
                document.getElementById('cw-feedback').className = "text-red-600 font-bold h-6 mb-2";
                setTimeout(() => cwSwitchTurn(false), 1500);
            }
        }

        function cwSwitchTurn(timeout) {
            clearInterval(cwState.timerInterval);
            if(timeout) playSound('wrong');
            cwState.turn = cwState.turn === 1 ? 2 : 1;
            cwState.userAns = [];
            cwState.timer = 60;
            updateCwTurnUI();
            renderCwGrid();
            startCwTimer();
            document.getElementById('cw-feedback').innerText = "";
        }

        function updateCwUI() {
            document.getElementById('cw-t1-score').innerText = cwState.score1;
            document.getElementById('cw-t2-score').innerText = cwState.score2;
            document.getElementById('cw-t1-hearts').innerText = "โค๏ธ".repeat(cwState.hints1) + "๐ค".repeat(5 - cwState.hints1);
            document.getElementById('cw-t2-hearts').innerText = "โค๏ธ".repeat(cwState.hints2) + "๐ค".repeat(5 - cwState.hints2);
        }

        function updateCwTurnUI() {
            const t1Box = document.getElementById('cw-t1-box');
            const t2Box = document.getElementById('cw-t2-box');
            const msg = document.getElementById('cw-turn-msg');
            const name = cwState.turn === 1 ? gState.team1 : gState.team2;
            msg.innerText = `ุฏูุฑ: ${name}`;
            if(cwState.turn === 1) {
                t1Box.classList.remove('opacity-50', 'border-transparent');
                t1Box.classList.add('border-green-500', 'bg-green-50', 'scale-105', 'shadow-md');
                t2Box.classList.add('opacity-50', 'border-transparent');
                t2Box.classList.remove('border-blue-500', 'bg-blue-50', 'scale-105', 'shadow-md');
            } else {
                t2Box.classList.remove('opacity-50', 'border-transparent');
                t2Box.classList.add('border-blue-500', 'bg-blue-50', 'scale-105', 'shadow-md');
                t1Box.classList.add('opacity-50', 'border-transparent');
                t1Box.classList.remove('border-green-500', 'bg-green-50', 'scale-105', 'shadow-md');
            }
        }

        function cwUseHint() {
            const teamHints = cwState.turn === 1 ? cwState.hints1 : cwState.hints2;
            if(teamHints > 0) {
                playSound('click');
                const ans = cwState.currentQ.a;
                let idx = -1;
                for(let i=0; i<ans.length; i++) {
                    if(cwState.userAns[i] !== ans[i]) { idx = i; break; }
                }
                if(idx !== -1) {
                    let newAns = [];
                    for(let i=0; i<idx; i++) newAns.push(ans[i]);
                    newAns.push(ans[idx]);
                    cwState.userAns = newAns;
                    renderCwGrid();
                    if(cwState.turn === 1) cwState.hints1--; else cwState.hints2--;
                    updateCwUI();
                    
                    const currentStr = normalizeText(cwState.userAns.join(''));
                    const targetStr = normalizeText(ans);
                    if(currentStr === targetStr) checkCwAnswer();
                }
            } else {
                playSound('wrong');
                alert("ุงูุชูุช ุงููุณุงุนุฏุงุช!");
            }
        }

        // --- HEXAGON LOGIC ---
        let hexState = {
            grid: [], 
            turn: 1, 
            selectedCell: -1,
            targetAnswer: "",
            rounds1: 0,
            rounds2: 0,
            currentRound: 1,
            timer: 60,
            timerInterval: null
        };
        
        function initHexagon() {
            hexState.turn = 1;
            hexState.rounds1 = 0;
            hexState.rounds2 = 0;
            hexState.currentRound = 1;
            hexState.timer = 60;
            
            document.getElementById('hex-t1-name').innerText = gState.team1;
            document.getElementById('hex-t2-name').innerText = gState.team2;
            
            updateHexRoundUI();
            resetHexBoard();
            showScreen('screen-hexagon');
        }

        function resetHexBoard() {
            try {
                clearInterval(hexState.timerInterval);
                hexState.grid = [];
                hexState.selectedCell = -1;
                hexState.turn = (hexState.currentRound % 2 === 0) ? 2 : 1; 
                hexState.timer = 60;
                
                const chars = "ุงุจุชุซุฌุญุฎุฏุฐุฑุฒุณุดุตุถุทุธุนุบููููููููู";
                for(let i=0; i<25; i++) {
                    hexState.grid.push({
                        id: i,
                        char: chars[Math.floor(Math.random() * chars.length)],
                        owner: 0 
                    });
                }
                renderHexBoard();
                updateHexTurnUI();
            } catch(e) {
                console.error('Error in resetHexBoard:', e);
            }
        }

        function renderHexBoard() {
            const board = document.getElementById('hex-board');
            board.innerHTML = '';
            
            for(let r=0; r<5; r++) {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'hex-row';
                for(let c=0; c<5; c++) {
                    const idx = r*5 + c;
                    const cellData = hexState.grid[idx];
                    const cell = document.createElement('div');
                    cell.className = `hex-cell ${cellData.owner === 1 ? 'team1' : cellData.owner === 2 ? 'team2' : ''}`;
                    if(cellData.owner !== 0) cell.classList.add('locked');
                    cell.innerText = cellData.char;
                    cell.onclick = () => hexCellClick(idx);
                    rowDiv.appendChild(cell);
                }
                board.appendChild(rowDiv);
            }
        }

        function hexCellClick(idx) {
            const cell = hexState.grid[idx];
            if(cell.owner !== 0) return; 
            
            hexState.selectedCell = idx;
            playSound('click');
            
            const possibleQs = questionBank.filter(q => q.char === cell.char);
            let qObj;
            if(possibleQs.length > 0) {
                qObj = possibleQs[Math.floor(Math.random() * possibleQs.length)];
            } else {
                qObj = questionBank[Math.floor(Math.random() * questionBank.length)];
            }
            
            hexState.targetAnswer = qObj.a;
            
            document.getElementById('hex-q-char').innerText = cell.char;
            document.getElementById('hex-question-text').innerText = qObj.q;
            document.getElementById('hex-input').value = "";
            document.getElementById('hex-feedback').innerText = "";
            document.getElementById('hex-feedback').className = "h-6 mt-3 text-sm font-bold";
            
            document.getElementById('hex-modal').classList.remove('hidden');
            document.getElementById('hex-input').focus();
            
            hexState.timer = 60;
            startHexTimer();
        }

        function closeHexModal() {
            document.getElementById('hex-modal').classList.add('hidden');
            clearInterval(hexState.timerInterval);
        }

        function checkHexAnswer() {
            const userIn = document.getElementById('hex-input').value;
            const target = hexState.targetAnswer;
            
            if(isSmartMatch(userIn, target)) {
                clearInterval(hexState.timerInterval);
                playSound('correct');
                document.getElementById('hex-feedback').innerText = "ุฅุฌุงุจุฉ ุตุญูุญุฉ! โ";
                document.getElementById('hex-feedback').className = "h-6 mt-3 text-sm font-bold text-green-600";
                
                setTimeout(() => {
                    closeHexModal();
                    hexState.grid[hexState.selectedCell].owner = hexState.turn;
                    renderHexBoard();
                    
                    if(checkHexWin(hexState.turn)) {
                        handleRoundWin(hexState.turn);
                    } else {
                        switchHexTurn();
                    }
                }, 1000);
                
            } else {
                clearInterval(hexState.timerInterval);
                playSound('wrong');
                document.getElementById('hex-feedback').innerText = "ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ โ";
                document.getElementById('hex-feedback').className = "h-6 mt-3 text-sm font-bold text-red-600";
                
                setTimeout(() => {
                    closeHexModal();
                    switchHexTurn();
                }, 2000);
            }
        }

        function handleRoundWin(team) {
            playSound('correct');
            if (team === 1) hexState.rounds1++;
            else hexState.rounds2++;
            
            updateHexRoundUI();
            
            if (hexState.rounds1 >= 3 || hexState.rounds2 >= 3) {
                const winner = hexState.rounds1 > hexState.rounds2 ? gState.team1 : gState.team2;
                setTimeout(() => showWin(winner), 500);
            } else {
                const winnerName = team === 1 ? gState.team1 : gState.team2;
                document.getElementById('round-winner-name').innerText = winnerName;
                document.getElementById('round-win-modal').classList.remove('hidden');
            }
        }

        function startNextHexRound() {
            document.getElementById('round-win-modal').classList.add('hidden');
            hexState.currentRound++;
            resetHexBoard();
        }

        function updateHexRoundUI() {
            const getStars = (count) => {
                let s = "";
                for(let i=0; i<3; i++) {
                    s += i < count ? "<span class='text-yellow-400'>โ</span>" : "<span class='text-gray-200'>โ</span>";
                }
                return s;
            };
            document.getElementById('hex-t1-wins').innerHTML = getStars(hexState.rounds1);
            document.getElementById('hex-t2-wins').innerHTML = getStars(hexState.rounds2);
        }

        function switchHexTurn() {
            hexState.turn = hexState.turn === 1 ? 2 : 1;
            updateHexTurnUI();
        }

        function updateHexTurnUI() {
            const t1 = document.getElementById('hex-t1-box');
            const t2 = document.getElementById('hex-t2-box');
            const stat = document.getElementById('hex-status');
            const name = hexState.turn === 1 ? gState.team1 : gState.team2;
            
            stat.innerText = `ุฏูุฑ ${name} ูุงุฎุชูุงุฑ ุญุฑู`;
            stat.className = hexState.turn === 1 
                ? "text-center text-sm font-bold py-2 bg-green-100 text-green-800 border-y border-green-200"
                : "text-center text-sm font-bold py-2 bg-red-100 text-red-800 border-y border-red-200";

            if(hexState.turn === 1) {
                t1.classList.remove('opacity-50', 'border-transparent');
                t1.classList.add('border-green-400', 'bg-green-50', 'scale-105', 'shadow-md');
                t2.classList.add('opacity-50', 'border-transparent');
                t2.classList.remove('border-red-400', 'bg-red-50', 'scale-105', 'shadow-md');
            } else {
                t2.classList.remove('opacity-50', 'border-transparent');
                t2.classList.add('border-red-400', 'bg-red-50', 'scale-105', 'shadow-md');
                t1.classList.add('opacity-50', 'border-transparent');
                t1.classList.remove('border-green-400', 'bg-green-50', 'scale-105', 'shadow-md');
            }
        }

        function checkHexWin(player) {
            const visited = new Set();
            const queue = [];
            for(let i=0; i<25; i++) {
                if(hexState.grid[i].owner === player) {
                    let r = Math.floor(i/5);
                    let c = i%5;
                    if(player === 1 && c === 0) queue.push(i); 
                    if(player === 2 && r === 0) queue.push(i); 
                }
            }
            while(queue.length > 0) {
                const curr = queue.shift();
                if(visited.has(curr)) continue;
                visited.add(curr);
                const r = Math.floor(curr/5);
                const c = curr%5;
                if(player === 1 && c === 4) return true; 
                if(player === 2 && r === 4) return true; 
                const neighbors = [curr-5, curr+5, curr-1, curr+1, curr-6, curr-4, curr+4, curr+6];
                for(let n of neighbors) {
                    if(n >= 0 && n < 25 && hexState.grid[n].owner === player && !visited.has(n)) {
                        const nr = Math.floor(n/5);
                        const nc = n%5;
                        if(Math.abs(nr-r) <= 1 && Math.abs(nc-c) <= 1) { 
                             queue.push(n);
                        }
                    }
                }
            }
            return false;
        }

        function startHexTimer() {
            const timerEl = document.getElementById('hex-modal-timer');
            timerEl.innerText = hexState.timer;
            timerEl.classList.remove('bg-red-600', 'animate-pulse');
            timerEl.classList.add('bg-[#1a472a]');

            hexState.timerInterval = setInterval(() => {
                hexState.timer--;
                timerEl.innerText = hexState.timer;
                
                if(hexState.timer <= 10 && hexState.timer > 0) {
                    timerEl.classList.add('bg-red-600', 'animate-pulse');
                    timerEl.classList.remove('bg-[#1a472a]');
                    if(hexState.timer === 10 || hexState.timer === 5 || hexState.timer === 1) {
                        playSound('warning');
                    }
                }
                
                if(hexState.timer <= 0) {
                    clearInterval(hexState.timerInterval);
                    playSound('wrong');
                    closeHexModal();
                    switchHexTurn();
                }
            }, 1000);
        }

        // --- CONNECT 4 LOGIC (New Game) ---
        let c4State = {
            rows: 6,
            cols: 7,
            board: [], // 0 = empty, 1 = p1, 2 = p2
            turn: 1, // 1 or 2
            selectedCol: -1,
            targetAnswer: "",
            timer: 60,
            timerInterval: null
        };

        function initConnect4() {
            c4State.turn = 1;
            c4State.board = Array(c4State.rows).fill().map(() => Array(c4State.cols).fill(0));
            document.getElementById('c4-t1-name').innerText = gState.team1;
            document.getElementById('c4-t2-name').innerText = gState.team2;
            renderC4Board();
            updateC4TurnUI();
            showScreen('screen-connect4');
        }

        function renderC4Board() {
            const boardEl = document.getElementById('c4-board');
            boardEl.innerHTML = '';
            
            for (let c = 0; c < c4State.cols; c++) {
                const colEl = document.createElement('div');
                colEl.className = 'c4-col';
                colEl.onclick = () => handleC4ColClick(c);
                
                for (let r = 0; r < c4State.rows; r++) {
                    const cellEl = document.createElement('div');
                    const val = c4State.board[r][c];
                    cellEl.className = `c4-cell ${val === 1 ? 'p1' : val === 2 ? 'p2' : ''}`;
                    colEl.appendChild(cellEl);
                }
                boardEl.appendChild(colEl);
            }
        }

        function handleC4ColClick(colIdx) {
            // Check if column is full
            if (c4State.board[0][colIdx] !== 0) {
                playSound('wrong');
                return; // Column full
            }

            playSound('click');
            c4State.selectedCol = colIdx;

            // Pick random question from New Bank
            const qObj = c4QuestionBank[Math.floor(Math.random() * c4QuestionBank.length)];
            c4State.targetAnswer = qObj.a;

            // Show Modal
            document.getElementById('c4-question-text').innerText = qObj.q;
            document.getElementById('c4-input').value = "";
            document.getElementById('c4-feedback').innerText = "";
            document.getElementById('c4-feedback').className = "h-6 mt-3 text-sm font-bold";
            document.getElementById('c4-modal').classList.remove('hidden');
            document.getElementById('c4-input').focus();

            // Start Timer
            c4State.timer = 60;
            startC4Timer();
        }

        function startC4Timer() {
            const timerEl = document.getElementById('c4-modal-timer');
            timerEl.innerText = c4State.timer;
            timerEl.classList.remove('bg-red-600', 'animate-pulse');
            timerEl.classList.add('bg-[#1a472a]');

            c4State.timerInterval = setInterval(() => {
                c4State.timer--;
                timerEl.innerText = c4State.timer;
                
                if(c4State.timer <= 10 && c4State.timer > 0) {
                    timerEl.classList.add('bg-red-600', 'animate-pulse');
                    timerEl.classList.remove('bg-[#1a472a]');
                    if(c4State.timer === 10 || c4State.timer === 5 || c4State.timer === 1) {
                        playSound('warning');
                    }
                }
                
                if(c4State.timer <= 0) {
                    clearInterval(c4State.timerInterval);
                    playSound('wrong');
                    closeC4Modal();
                    switchC4Turn(); // Timeout = lose turn
                }
            }, 1000);
        }

        function closeC4Modal() {
            document.getElementById('c4-modal').classList.add('hidden');
            clearInterval(c4State.timerInterval);
        }

        function checkC4Answer() {
            const userIn = document.getElementById('c4-input').value;
            const target = c4State.targetAnswer;

            if (isSmartMatch(userIn, target)) {
                // Correct
                clearInterval(c4State.timerInterval);
                playSound('correct');
                document.getElementById('c4-feedback').innerText = "ุฅุฌุงุจุฉ ุตุญูุญุฉ! โ";
                document.getElementById('c4-feedback').className = "h-6 mt-3 text-sm font-bold text-green-600";

                setTimeout(() => {
                    closeC4Modal();
                    dropC4Piece(c4State.selectedCol);
                }, 1000);

            } else {
                // Wrong
                clearInterval(c4State.timerInterval);
                playSound('wrong');
                document.getElementById('c4-feedback').innerText = "ุฅุฌุงุจุฉ ุฎุงุทุฆุฉ โ";
                document.getElementById('c4-feedback').className = "h-6 mt-3 text-sm font-bold text-red-600";

                setTimeout(() => {
                    closeC4Modal();
                    switchC4Turn(); // Wrong answer = lose turn
                }, 1500);
            }
        }

        function dropC4Piece(colIdx) {
            // Find lowest empty row
            for (let r = c4State.rows - 1; r >= 0; r--) {
                if (c4State.board[r][colIdx] === 0) {
                    c4State.board[r][colIdx] = c4State.turn;
                    renderC4Board();
                    
                    if (checkC4Win(r, colIdx)) {
                        setTimeout(() => showWin(c4State.turn === 1 ? gState.team1 : gState.team2), 500);
                    } else {
                        switchC4Turn();
                    }
                    return;
                }
            }
        }

        function switchC4Turn() {
            c4State.turn = c4State.turn === 1 ? 2 : 1;
            updateC4TurnUI();
        }

        function updateC4TurnUI() {
            const t1 = document.getElementById('c4-t1-box');
            const t2 = document.getElementById('c4-t2-box');
            const status = document.getElementById('c4-status');
            const name = c4State.turn === 1 ? gState.team1 : gState.team2;

            status.innerText = `ุฏูุฑ ${name}`;
            
            if (c4State.turn === 1) {
                t1.classList.remove('opacity-50');
                t1.classList.add('scale-105', 'shadow-md', 'bg-green-100');
                t2.classList.add('opacity-50');
                t2.classList.remove('scale-105', 'shadow-md', 'bg-red-100');
                t2.classList.add('bg-red-50');
            } else {
                t2.classList.remove('opacity-50');
                t2.classList.add('scale-105', 'shadow-md', 'bg-red-100');
                t1.classList.add('opacity-50');
                t1.classList.remove('scale-105', 'shadow-md', 'bg-green-100');
                t1.classList.add('bg-green-50');
            }
        }

        function checkC4Win(row, col) {
            const player = c4State.board[row][col];
            const directions = [
                [0, 1],  // Horizontal
                [1, 0],  // Vertical
                [1, 1],  // Diagonal /
                [1, -1]  // Diagonal \
            ];

            for (let [dr, dc] of directions) {
                let count = 1;
                // Check positive direction
                for (let i = 1; i < 4; i++) {
                    const r = row + dr * i;
                    const c = col + dc * i;
                    if (r < 0 || r >= c4State.rows || c < 0 || c >= c4State.cols || c4State.board[r][c] !== player) break;
                    count++;
                }
                // Check negative direction
                for (let i = 1; i < 4; i++) {
                    const r = row - dr * i;
                    const c = col - dc * i;
                    if (r < 0 || r >= c4State.rows || c < 0 || c >= c4State.cols || c4State.board[r][c] !== player) break;
                    count++;
                }
                if (count >= 4) return true;
            }
            return false;
        }

        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }
    </script>
    
    <footer style="text-align: center; padding: 20px; margin-top: 20px; font-size: 12px; font-weight: 300; color: #1a472a; letter-spacing: 0.5px;">
        ุจุฑูุฌุฉ ูุชุตููู Abo azzam
    </footer>
</body>
</html>